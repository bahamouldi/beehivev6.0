"""
BeeWAF Mega Rules Database â€” Part 8
=====================================
More granular attack signatures: CMS-specific, WordPress plugins,
API endpoints, HTTP smuggling, cache poisoning, protocol attacks, 
XXE variants, LDAP injection, and more.
~1600 additional patterns.
"""

# ============================================================================
# 1. WORDPRESS DEEP (250 patterns)
# ============================================================================
WORDPRESS_DEEP = [
    r"(?i)/wp-admin/admin-ajax\.php\b",
    r"(?i)/wp-admin/admin-post\.php\b",
    r"(?i)/wp-admin/async-upload\.php\b",
    r"(?i)/wp-admin/edit\.php\b",
    r"(?i)/wp-admin/edit-tags\.php\b",
    r"(?i)/wp-admin/export\.php\b",
    r"(?i)/wp-admin/import\.php\b",
    r"(?i)/wp-admin/install\.php\b",
    r"(?i)/wp-admin/link-manager\.php\b",
    r"(?i)/wp-admin/load-scripts\.php\b",
    r"(?i)/wp-admin/load-styles\.php\b",
    r"(?i)/wp-admin/media-new\.php\b",
    r"(?i)/wp-admin/nav-menus\.php\b",
    r"(?i)/wp-admin/network/\b",
    r"(?i)/wp-admin/options-general\.php\b",
    r"(?i)/wp-admin/options-writing\.php\b",
    r"(?i)/wp-admin/options-reading\.php\b",
    r"(?i)/wp-admin/options-discussion\.php\b",
    r"(?i)/wp-admin/options-media\.php\b",
    r"(?i)/wp-admin/options-permalink\.php\b",
    r"(?i)/wp-admin/options\.php\b",
    r"(?i)/wp-admin/plugin-editor\.php\b",
    r"(?i)/wp-admin/plugin-install\.php\b",
    r"(?i)/wp-admin/plugins\.php\b",
    r"(?i)/wp-admin/post\.php\b",
    r"(?i)/wp-admin/post-new\.php\b",
    r"(?i)/wp-admin/profile\.php\b",
    r"(?i)/wp-admin/setup-config\.php\b",
    r"(?i)/wp-admin/site-health\.php\b",
    r"(?i)/wp-admin/theme-editor\.php\b",
    r"(?i)/wp-admin/theme-install\.php\b",
    r"(?i)/wp-admin/themes\.php\b",
    r"(?i)/wp-admin/tools\.php\b",
    r"(?i)/wp-admin/update\.php\b",
    r"(?i)/wp-admin/update-core\.php\b",
    r"(?i)/wp-admin/upgrade\.php\b",
    r"(?i)/wp-admin/upload\.php\b",
    r"(?i)/wp-admin/user-edit\.php\b",
    r"(?i)/wp-admin/user-new\.php\b",
    r"(?i)/wp-admin/users\.php\b",
    r"(?i)/wp-admin/widgets\.php\b",
    r"(?i)/wp-content/debug\.log\b",
    r"(?i)/wp-content/uploads/\b",
    r"(?i)/wp-content/backup\b",
    r"(?i)/wp-content/backups\b",
    r"(?i)/wp-content/cache\b",
    r"(?i)/wp-content/db\.php\b",
    r"(?i)/wp-content/mysql\.sql\b",
    r"(?i)/wp-content/object-cache\.php\b",
    r"(?i)/wp-content/advanced-cache\.php\b",
    r"(?i)/wp-content/upgrade\b",
    r"(?i)/wp-includes/version\.php\b",
    r"(?i)/wp-includes/class-wp-\w+\.php\b",
    r"(?i)/wp-includes/wp-db\.php\b",
    r"(?i)/wp-includes/formatting\.php\b",
    r"(?i)/wp-includes/pluggable\.php\b",
    r"(?i)/wp-cron\.php\b",
    r"(?i)/wp-login\.php\b",
    r"(?i)/wp-signup\.php\b",
    r"(?i)/wp-activate\.php\b",
    r"(?i)/wp-mail\.php\b",
    r"(?i)/wp-links-opml\.php\b",
    r"(?i)/wp-trackback\.php\b",
    r"(?i)/wp-comments-post\.php\b",
    r"(?i)/wp-json/wp/v2/users\b",
    r"(?i)/wp-json/wp/v2/posts\b",
    r"(?i)/wp-json/wp/v2/pages\b",
    r"(?i)/wp-json/wp/v2/media\b",
    r"(?i)/wp-json/wp/v2/comments\b",
    r"(?i)/wp-json/wp/v2/categories\b",
    r"(?i)/wp-json/wp/v2/tags\b",
    r"(?i)/wp-json/wp/v2/taxonomies\b",
    r"(?i)/wp-json/wp/v2/types\b",
    r"(?i)/wp-json/wp/v2/statuses\b",
    r"(?i)/wp-json/wp/v2/settings\b",
    r"(?i)/wp-json/wp/v2/plugins\b",
    r"(?i)/wp-json/wp/v2/themes\b",
    r"(?i)/wp-json/wp/v2/search\b",
    r"(?i)/wp-json/oembed/\b",
    r"(?i)/wp-json/\b.*\?rest_route=",
    r"(?i)\?rest_route=/wp/v2/users\b",
    r"(?i)\?author=\d+",
    r"(?i)/feed/\b",
    r"(?i)/rss/\b",
    r"(?i)/atom/\b",
    r"(?i)/sitemap\.xml\b",
    r"(?i)/xmlrpc\.php\b",
    r"(?i)/readme\.html\b",
    r"(?i)/license\.txt\b",
    r"(?i)/wp-config\.php\.bak\b",
    r"(?i)/wp-config\.php\.old\b",
    r"(?i)/wp-config\.php\.save\b",
    r"(?i)/wp-config\.php\.swp\b",
    r"(?i)/wp-config\.php\.orig\b",
    r"(?i)/wp-config\.php~\b",
    r"(?i)/wp-config\.txt\b",
    r"(?i)/wp-config\.php\.tmp\b",
    r"(?i)/wp-config-sample\.php\b",
    r"(?i)action=(?:editedcomment|trashcomment|untrashcomment|spamcomment|deletecomment)\b",
    r"(?i)action=(?:activate|deactivate|delete-selected|update-selected)\b",
    r"(?i)action=(?:edit-theme-plugin-file|update|install-plugin|upload-plugin|install-theme|upload-theme)\b",
    # --- Vulnerable WP plugins ---
    r"(?i)/wp-content/plugins/revslider\b",
    r"(?i)/wp-content/plugins/contact-form-7\b",
    r"(?i)/wp-content/plugins/elementor\b",
    r"(?i)/wp-content/plugins/jetpack\b",
    r"(?i)/wp-content/plugins/woocommerce\b",
    r"(?i)/wp-content/plugins/yoast-seo\b",
    r"(?i)/wp-content/plugins/akismet\b",
    r"(?i)/wp-content/plugins/wordfence\b",
    r"(?i)/wp-content/plugins/wp-file-manager\b",
    r"(?i)/wp-content/plugins/duplicator\b",
    r"(?i)/wp-content/plugins/all-in-one-wp-migration\b",
    r"(?i)/wp-content/plugins/updraftplus\b",
    r"(?i)/wp-content/plugins/wp-super-cache\b",
    r"(?i)/wp-content/plugins/w3-total-cache\b",
    r"(?i)/wp-content/plugins/really-simple-ssl\b",
    r"(?i)/wp-content/plugins/loginizer\b",
    r"(?i)/wp-content/plugins/limit-login-attempts\b",
    r"(?i)/wp-content/plugins/wp-statistics\b",
    r"(?i)/wp-content/plugins/google-analytics\b",
    r"(?i)/wp-content/plugins/monsterinsights\b",
    r"(?i)/wp-content/plugins/classic-editor\b",
    r"(?i)/wp-content/plugins/tinymce-advanced\b",
    r"(?i)/wp-content/plugins/tablepress\b",
    r"(?i)/wp-content/plugins/wp-mail-smtp\b",
    r"(?i)/wp-content/plugins/redirection\b",
    r"(?i)/wp-content/plugins/broken-link-checker\b",
    r"(?i)/wp-content/plugins/social-warfare\b",
    r"(?i)/wp-content/plugins/easy-wp-smtp\b",
    r"(?i)/wp-content/plugins/ninja-forms\b",
    r"(?i)/wp-content/plugins/wpforms\b",
    r"(?i)/wp-content/plugins/formidable\b",
    r"(?i)/wp-content/plugins/gravity-forms\b",
    r"(?i)/wp-content/plugins/advanced-custom-fields\b",
    r"(?i)/wp-content/plugins/custom-post-type-ui\b",
    r"(?i)/wp-content/plugins/sucuri-scanner\b",
    r"(?i)/wp-content/plugins/ithemes-security\b",
    r"(?i)/wp-content/plugins/bulletproof-security\b",
    r"(?i)/wp-content/plugins/wp-fastest-cache\b",
    r"(?i)/wp-content/plugins/autoptimize\b",
    r"(?i)/wp-content/plugins/wp-optimize\b",
    r"(?i)/wp-content/plugins/ewww-image-optimizer\b",
    r"(?i)/wp-content/plugins/smush\b",
    r"(?i)/wp-content/plugins/shortpixel\b",
    r"(?i)/wp-content/plugins/imagify\b",
    r"(?i)/wp-content/plugins/amp\b",
    r"(?i)/wp-content/plugins/mailchimp-for-wp\b",
    r"(?i)/wp-content/plugins/mailpoet\b",
    r"(?i)/wp-content/plugins/newsletter\b",
    r"(?i)/wp-content/plugins/popup-maker\b",
    r"(?i)/wp-content/plugins/optinmonster\b",
    r"(?i)/wp-content/plugins/sumo\b",
    r"(?i)/wp-content/plugins/beaver-builder\b",
    r"(?i)/wp-content/plugins/divi-builder\b",
    r"(?i)/wp-content/plugins/visual-composer\b",
    r"(?i)/wp-content/plugins/brizy\b",
    r"(?i)/wp-content/plugins/themify-builder\b",
    r"(?i)/wp-content/plugins/oxygen\b",
    r"(?i)/wp-content/plugins/generatepress\b",
    r"(?i)/wp-content/plugins/astra\b",
    r"(?i)/wp-content/plugins/oceanwp\b",
    r"(?i)/wp-content/plugins/starter-templates\b",
    r"(?i)/wp-content/plugins/kadence-blocks\b",
    r"(?i)/wp-content/plugins/spectra\b",
    r"(?i)/wp-content/plugins/stackable-ultimate-gutenberg-blocks\b",
    r"(?i)/wp-content/plugins/ultimate-addons-for-gutenberg\b",
    r"(?i)/wp-content/plugins/essential-addons-for-elementor\b",
    r"(?i)/wp-content/plugins/premium-addons-for-elementor\b",
    r"(?i)/wp-content/plugins/happy-addons-for-elementor\b",
    r"(?i)/wp-content/plugins/royal-elementor-addons\b",
    r"(?i)/wp-content/plugins/theme-jesuspended\b",
    r"(?i)/wp-content/plugins/wp-reset\b",
    r"(?i)/wp-content/plugins/wp-phpMyAdmin\b",
    r"(?i)/wp-content/plugins/adminer\b",
    r"(?i)/wp-content/plugins/db-manager\b",
    r"(?i)/wp-content/plugins/database-browser\b",
    r"(?i)/wp-content/plugins/backwpup\b",
    r"(?i)/wp-content/plugins/xcloner\b",
    r"(?i)/wp-content/plugins/developer\b",
    r"(?i)/wp-content/plugins/theme-check\b",
    r"(?i)/wp-content/plugins/debug-bar\b",
    r"(?i)/wp-content/plugins/query-monitor\b",
    r"(?i)/wp-content/plugins/user-role-editor\b",
    r"(?i)/wp-content/plugins/members\b",
    r"(?i)/wp-content/plugins/capability-manager-enhanced\b",
    r"(?i)/wp-content/plugins/download-monitor\b",
    r"(?i)/wp-content/plugins/wordpress-importer\b",
    r"(?i)/wp-content/plugins/regenerate-thumbnails\b",
    r"(?i)/wp-content/plugins/enable-media-replace\b",
    r"(?i)/wp-content/plugins/file-manager-advanced\b",
    r"(?i)/wp-content/plugins/file-manager\b",
    r"(?i)/wp-content/plugins/frontend-file-manager\b",
]

# ============================================================================
# 2. CMS JOOMLA / DRUPAL / MAGENTO (200 patterns)
# ============================================================================
CMS_OTHER_DEEP = [
    # Joomla
    r"(?i)/administrator/index\.php\b",
    r"(?i)/administrator/manifests\b",
    r"(?i)/administrator/components\b",
    r"(?i)/administrator/modules\b",
    r"(?i)/administrator/templates\b",
    r"(?i)/administrator/logs\b",
    r"(?i)/administrator/cache\b",
    r"(?i)/administrator/help\b",
    r"(?i)/configuration\.php\b",
    r"(?i)/configuration\.php\.bak\b",
    r"(?i)/configuration\.php\.old\b",
    r"(?i)/configuration\.php\.dist\b",
    r"(?i)/htaccess\.txt\b",
    r"(?i)/web\.config\.txt\b",
    r"(?i)/joomla\.xml\b",
    r"(?i)/language/en-GB/en-GB\.xml\b",
    r"(?i)/components/com_\w+\b",
    r"(?i)/modules/mod_\w+\b",
    r"(?i)/plugins/\w+/\w+\b",
    r"(?i)/templates/\w+/templateDetails\.xml\b",
    r"(?i)/libraries/joomla\b",
    r"(?i)/libraries/cms\b",
    r"(?i)/libraries/fof\b",
    r"(?i)/libraries/phputf8\b",
    r"(?i)/media/system\b",
    r"(?i)/media/jui\b",
    r"(?i)/cache/\w+\.php\b",
    r"(?i)/tmp/\w+\.php\b",
    r"(?i)/logs/error\.php\b",
    r"(?i)option=com_users\b",
    r"(?i)option=com_content\b",
    r"(?i)option=com_config\b",
    r"(?i)option=com_installer\b",
    r"(?i)option=com_templates\b",
    r"(?i)option=com_plugins\b",
    r"(?i)option=com_modules\b",
    r"(?i)option=com_media\b",
    r"(?i)option=com_menus\b",
    r"(?i)option=com_categories\b",
    r"(?i)option=com_banners\b",
    r"(?i)option=com_finder\b",
    r"(?i)option=com_fields\b",
    r"(?i)option=com_actionlogs\b",
    r"(?i)option=com_admin\b",
    r"(?i)option=com_checkin\b",
    r"(?i)option=com_redirect\b",
    r"(?i)option=com_joomlaupdate\b",
    r"(?i)option=com_login\b",
    r"(?i)task=user\.login\b",
    r"(?i)task=user\.register\b",
    # Drupal
    r"(?i)/user/login\b",
    r"(?i)/user/register\b",
    r"(?i)/user/password\b",
    r"(?i)/admin/content\b",
    r"(?i)/admin/structure\b",
    r"(?i)/admin/appearance\b",
    r"(?i)/admin/modules\b",
    r"(?i)/admin/config\b",
    r"(?i)/admin/people\b",
    r"(?i)/admin/reports\b",
    r"(?i)/admin/help\b",
    r"(?i)/node/add\b",
    r"(?i)/node/\d+/edit\b",
    r"(?i)/node/\d+/delete\b",
    r"(?i)/core/install\.php\b",
    r"(?i)/core/update\.php\b",
    r"(?i)/core/rebuild\.php\b",
    r"(?i)/core/modules\b",
    r"(?i)/core/themes\b",
    r"(?i)/core/profiles\b",
    r"(?i)/core/CHANGELOG\.txt\b",
    r"(?i)/CHANGELOG\.txt\b",
    r"(?i)/INSTALL\.txt\b",
    r"(?i)/UPGRADE\.txt\b",
    r"(?i)/MAINTAINERS\.txt\b",
    r"(?i)/sites/default/settings\.php\b",
    r"(?i)/sites/default/default\.settings\.php\b",
    r"(?i)/sites/default/files\b",
    r"(?i)/modules/\w+/\w+\.info\.yml\b",
    r"(?i)/themes/\w+/\w+\.info\.yml\b",
    r"(?i)/jsonapi/\b",
    r"(?i)/rest/\b",
    r"(?i)/graphql\b",
    # Magento
    r"(?i)/magento/\b",
    r"(?i)/downloader/\b",
    r"(?i)/app/etc/local\.xml\b",
    r"(?i)/app/etc/env\.php\b",
    r"(?i)/app/etc/config\.php\b",
    r"(?i)/var/log/system\.log\b",
    r"(?i)/var/log/exception\.log\b",
    r"(?i)/var/log/debug\.log\b",
    r"(?i)/var/report/\b",
    r"(?i)/var/export/\b",
    r"(?i)/var/import/\b",
    r"(?i)/var/backups/\b",
    r"(?i)/pub/static/\b",
    r"(?i)/pub/media/\b",
    r"(?i)/rest/V1/\b",
    r"(?i)/rest/V1/store\b",
    r"(?i)/rest/V1/products\b",
    r"(?i)/rest/V1/customers\b",
    r"(?i)/rest/V1/carts\b",
    r"(?i)/rest/V1/orders\b",
    r"(?i)/rest/V1/integration\b",
    r"(?i)/rest/all/V1/\b",
    r"(?i)/graphql\?query=\b",
    r"(?i)/admin_\w+\b",
    r"(?i)/index\.php/admin\b",
    # --- Other CMS ---
    r"(?i)/typo3/\b",
    r"(?i)/typo3conf/\b",
    r"(?i)/typo3temp/\b",
    r"(?i)/sitecore/\b",
    r"(?i)/sitecore/admin\b",
    r"(?i)/sitecore/shell\b",
    r"(?i)/sitecore/login\b",
    r"(?i)/umbraco/\b",
    r"(?i)/umbraco/backoffice\b",
    r"(?i)/ghost/\b",
    r"(?i)/ghost/api\b",
    r"(?i)/strapi/\b",
    r"(?i)/directus/\b",
    r"(?i)/cockpit/\b",
    r"(?i)/keystone/\b",
    r"(?i)/craft/\b",
    r"(?i)/craft/admin\b",
    r"(?i)/silverstripe/\b",
    r"(?i)/contao/\b",
    r"(?i)/concrete5/\b",
    r"(?i)/processwire/\b",
    r"(?i)/modx/\b",
    r"(?i)/textpattern/\b",
    r"(?i)/grav/\b",
    r"(?i)/kirby/\b",
    r"(?i)/statamic/\b",
    r"(?i)/october/\b",
    r"(?i)/bolt/\b",
    r"(?i)/pimcore/\b",
    r"(?i)/moodle/\b",
    r"(?i)/canvas/\b",
    r"(?i)/blackboard/\b",
    r"(?i)/sakai/\b",
    r"(?i)/ilias/\b",
    r"(?i)/chamilo/\b",
    r"(?i)/efront/\b",
    r"(?i)/claroline/\b",
    r"(?i)/atutor/\b",
    r"(?i)/mediawiki/\b",
    r"(?i)/dokuwiki/\b",
    r"(?i)/confluence/\b",
    r"(?i)/xwiki/\b",
    r"(?i)/tiki/\b",
    r"(?i)/phpbb/\b",
    r"(?i)/vbulletin/\b",
    r"(?i)/mybb/\b",
    r"(?i)/smf/\b",
    r"(?i)/vanilla/\b",
    r"(?i)/flarum/\b",
    r"(?i)/discourse/\b",
    r"(?i)/nodebb/\b",
    r"(?i)/opencart/\b",
    r"(?i)/prestashop/\b",
    r"(?i)/oscommerce/\b",
    r"(?i)/zen-cart/\b",
    r"(?i)/cubecart/\b",
    r"(?i)/x-cart/\b",
    r"(?i)/cs-cart/\b",
    r"(?i)/shopware/\b",
    r"(?i)/bigcommerce/\b",
    r"(?i)/wix/\b",
    r"(?i)/squarespace/\b",
    r"(?i)/weebly/\b",
]

# ============================================================================
# 3. XXE DEEP PATTERNS (150 patterns)
# ============================================================================
XXE_DEEP = [
    r"(?i)<!DOCTYPE\s+\w+\s+SYSTEM\b",
    r"(?i)<!DOCTYPE\s+\w+\s+PUBLIC\b",
    r"(?i)<!DOCTYPE\s+\w+\s*\[\s*<!ENTITY\b",
    r"(?i)<!ENTITY\s+\w+\s+SYSTEM\b",
    r"(?i)<!ENTITY\s+\w+\s+PUBLIC\b",
    r"(?i)<!ENTITY\s+%\s*\w+\s+SYSTEM\b",
    r"(?i)<!ENTITY\s+%\s*\w+\s+PUBLIC\b",
    r"(?i)<!ENTITY\s+\w+\s+SYSTEM\s+['\"]file://",
    r"(?i)<!ENTITY\s+\w+\s+SYSTEM\s+['\"]http://",
    r"(?i)<!ENTITY\s+\w+\s+SYSTEM\s+['\"]https://",
    r"(?i)<!ENTITY\s+\w+\s+SYSTEM\s+['\"]ftp://",
    r"(?i)<!ENTITY\s+\w+\s+SYSTEM\s+['\"]gopher://",
    r"(?i)<!ENTITY\s+\w+\s+SYSTEM\s+['\"]dict://",
    r"(?i)<!ENTITY\s+\w+\s+SYSTEM\s+['\"]php://",
    r"(?i)<!ENTITY\s+\w+\s+SYSTEM\s+['\"]expect://",
    r"(?i)<!ENTITY\s+\w+\s+SYSTEM\s+['\"]data://",
    r"(?i)<!ENTITY\s+\w+\s+SYSTEM\s+['\"]jar://",
    r"(?i)<!ENTITY\s+\w+\s+SYSTEM\s+['\"]netdoc://",
    r"(?i)<!ENTITY\s+\w+\s+SYSTEM\s+['\"]ldap://",
    r"(?i)<!ENTITY\s+\w+\s+SYSTEM\s+['\"]ssh://",
    r"(?i)<!ENTITY\s+\w+\s+SYSTEM\s+['\"]telnet://",
    r"(?i)<!ENTITY\s+\w+\s+SYSTEM\s+['\"]\\\\",
    r"(?i)<!ENTITY\s+\w+\s+SYSTEM\s+['\"]file:///etc/passwd",
    r"(?i)<!ENTITY\s+\w+\s+SYSTEM\s+['\"]file:///etc/shadow",
    r"(?i)<!ENTITY\s+\w+\s+SYSTEM\s+['\"]file:///etc/hosts",
    r"(?i)<!ENTITY\s+\w+\s+SYSTEM\s+['\"]file:///proc/self",
    r"(?i)<!ENTITY\s+\w+\s+SYSTEM\s+['\"]file:///dev/random",
    r"(?i)<!ENTITY\s+\w+\s+SYSTEM\s+['\"]file:///dev/urandom",
    r"(?i)<!ENTITY\s+\w+\s+SYSTEM\s+['\"]file:///c:/boot\.ini",
    r"(?i)<!ENTITY\s+\w+\s+SYSTEM\s+['\"]file:///c:/windows/system\.ini",
    r"(?i)<!ENTITY\s+\w+\s+SYSTEM\s+['\"]file:///c:/windows/win\.ini",
    r"(?i)<!ENTITY\s+\w+\s+SYSTEM\s+['\"]php://filter/read=convert\.base64-encode/resource=",
    r"(?i)<!ENTITY\s+\w+\s+SYSTEM\s+['\"]php://filter/convert\.base64-encode/resource=",
    r"(?i)<!ENTITY\s+\w+\s+SYSTEM\s+['\"]php://filter/read=string\.rot13/resource=",
    r"(?i)<!ENTITY\s+\w+\s+SYSTEM\s+['\"]expect://\w+",
    r"(?i)<!ENTITY\s+\w+\s+SYSTEM\s+['\"]data://text/plain;base64,",
    r"(?i)<!ENTITY\s+%\s*\w+\s+SYSTEM\s+['\"]http://",
    r"(?i)<!ENTITY\s+%\s*\w+\s+SYSTEM\s+['\"]https://",
    r"(?i)<!ENTITY\s+%\s*\w+\s+SYSTEM\s+['\"]ftp://",
    r"(?i)<!ENTITY\s+%\s*\w+\s+SYSTEM\s+['\"]file://",
    r"(?i)%\w+;",
    r"(?i)&\w+;(?!(?:amp|lt|gt|quot|apos|nbsp);)",
    r"(?i)<!\[CDATA\[.*?\]\]>",
    r"(?i)<!\[INCLUDE\[",
    r"(?i)<!\[IGNORE\[",
    r"(?i)<?xml\s+version\s*=\s*['\"]1\.\d+['\"]",
    r"(?i)<?xml-stylesheet\s+",
    r"(?i)<xsl:import\b",
    r"(?i)<xsl:include\b",
    r"(?i)<xsl:value-of\b",
    r"(?i)<xsl:text\b",
    r"(?i)<xsl:variable\b",
    r"(?i)<xsl:param\b",
    r"(?i)<xsl:template\b",
    r"(?i)<xsl:apply-templates\b",
    r"(?i)<xsl:call-template\b",
    r"(?i)<xsl:for-each\b",
    r"(?i)<xsl:if\b",
    r"(?i)<xsl:choose\b",
    r"(?i)<xsl:when\b",
    r"(?i)<xsl:otherwise\b",
    r"(?i)<xsl:sort\b",
    r"(?i)<xsl:output\b",
    r"(?i)<xsl:copy-of\b",
    r"(?i)<xsl:element\b",
    r"(?i)<xsl:attribute\b",
    r"(?i)<xsl:processing-instruction\b",
    r"(?i)<xsl:comment\b",
    r"(?i)<xsl:number\b",
    r"(?i)<xsl:key\b",
    r"(?i)<xsl:decimal-format\b",
    r"(?i)<xsl:namespace-alias\b",
    r"(?i)<xsl:preserve-space\b",
    r"(?i)<xsl:strip-space\b",
    r"(?i)document\s*\(\s*['\"]http",
    r"(?i)document\s*\(\s*['\"]ftp",
    r"(?i)document\s*\(\s*['\"]file",
    r"(?i)unparsed-text\s*\(",
    r"(?i)unparsed-text-available\s*\(",
    r"(?i)unparsed-text-lines\s*\(",
    r"(?i)collection\s*\(",
    r"(?i)doc\s*\(\s*['\"]http",
    r"(?i)doc\s*\(\s*['\"]file",
    # --- SOAP XXE ---
    r"(?i)<soap:Envelope\b",
    r"(?i)<soap:Body\b",
    r"(?i)<soap:Header\b",
    r"(?i)<wsdl:definitions\b",
    r"(?i)<wsdl:types\b",
    r"(?i)<wsdl:message\b",
    r"(?i)<wsdl:portType\b",
    r"(?i)<wsdl:binding\b",
    r"(?i)<wsdl:service\b",
    r"(?i)<wsdl:port\b",
    # --- SVG XXE ---
    r"(?i)<svg\s+[^>]*onload\s*=",
    r"(?i)<svg\b[^>]*>.*<!ENTITY\b",
    r"(?i)<svg\b[^>]*>.*<script\b",
    r"(?i)<svg\b[^>]*>.*<foreignObject\b",
    r"(?i)<foreignObject\b",
    r"(?i)<animate\s+[^>]*begin\s*=",
    r"(?i)<animateTransform\b",
    r"(?i)<set\s+[^>]*attributeName\s*=\s*['\"]on\w+['\"]",
    # --- OOB XXE ---
    r"(?i)<!ENTITY\s+%\s*\w+\s+['\"]<!ENTITY\b",
    r"(?i)<!ENTITY\s+\w+\s+['\"]%\w+;['\"]",
    r"(?i)<!ENTITY\s+%\s*dtd\b",
    r"(?i)<!ENTITY\s+%\s*xxe\b",
    r"(?i)<!ENTITY\s+%\s*oob\b",
    r"(?i)<!ENTITY\s+%\s*exfil\b",
    r"(?i)<!ENTITY\s+%\s*payload\b",
    r"(?i)<!ENTITY\s+%\s*file\b",
    r"(?i)<!ENTITY\s+%\s*data\b",
    r"(?i)<!ENTITY\s+%\s*remote\b",
    r"(?i)<!ENTITY\s+%\s*eval\b",
    r"(?i)<!ENTITY\s+%\s*trick\b",
    r"(?i)<!ENTITY\s+xxe\b",
    r"(?i)<!ENTITY\s+file\b",
    r"(?i)<!ENTITY\s+payload\b",
    r"(?i)<!ENTITY\s+exfil\b",
    r"(?i)<!ENTITY\s+remote\b",
    # --- XML bomb / billion laughs ---
    r"(?i)<!ENTITY\s+\w+\s+['\"]&\w+;&\w+;&\w+",
    r"(?i)<!ENTITY\s+lol\b",
    r"(?i)<!ENTITY\s+lol\d\b",
    r"(?i)<!ENTITY\s+dos\b",
    r"(?i)<!ENTITY\s+bomb\b",
    r"(?i)ENTITY.*ENTITY.*ENTITY",
]

# ============================================================================
# 4. LDAP / XPATH / NOSQL INJECTION DEEP (200 patterns)
# ============================================================================
INJECTION_DEEP = [
    # LDAP Injection
    r"(?i)\(\|\(\w+=\*\)\)",
    r"(?i)\(&\(\w+=\*\)\)",
    r"(?i)\(\w+=\*\)\(\|\(\w+=",
    r"(?i)\(\w+=\*\)\)\%00",
    r"(?i)\(\w+=\w+\)\(\|\(\w+=",
    r"(?i)\*\)\(\|\(\w+=\*\)",
    r"(?i)\)\(\|\(\w+=\*\)\(",
    r"(?i)\)\%00",
    r"(?i)objectClass=\*",
    r"(?i)objectCategory=\*",
    r"(?i)cn=\*",
    r"(?i)uid=\*",
    r"(?i)sn=\*",
    r"(?i)givenName=\*",
    r"(?i)mail=\*",
    r"(?i)memberOf=\*",
    r"(?i)member=\*",
    r"(?i)distinguishedName=\*",
    r"(?i)userPassword=\*",
    r"(?i)sAMAccountName=\*",
    r"(?i)userPrincipalName=\*",
    r"(?i)adminCount=\*",
    r"(?i)servicePrincipalName=\*",
    r"(?i)msDS-AllowedToDelegateTo=\*",
    r"(?i)operatingSystem=\*",
    r"(?i)dNSHostName=\*",
    r"(?i)whenCreated=\*",
    r"(?i)whenChanged=\*",
    r"(?i)lastLogon=\*",
    r"(?i)pwdLastSet=\*",
    r"(?i)lockoutTime=\*",
    r"(?i)accountExpires=\*",
    r"(?i)primaryGroupID=\*",
    r"(?i)objectSid=\*",
    r"(?i)objectGUID=\*",
    # XPath Injection
    r"(?i)'\s*or\s+'1'\s*=\s*'1",
    r"(?i)'\s*and\s+'1'\s*=\s*'1",
    r"(?i)'\s*or\s+1\s*=\s*1",
    r"(?i)'\s*and\s+1\s*=\s*1",
    r"(?i)'\s*or\s+''\s*=\s*'",
    r"(?i)\[\s*position\s*\(\)\s*=\s*\d+\s*\]",
    r"(?i)\[\s*last\s*\(\)\s*\]",
    r"(?i)ancestor::\w+",
    r"(?i)descendant::\w+",
    r"(?i)following::\w+",
    r"(?i)preceding::\w+",
    r"(?i)parent::\w+",
    r"(?i)child::\w+",
    r"(?i)self::\w+",
    r"(?i)attribute::\w+",
    r"(?i)namespace::\w+",
    r"(?i)ancestor-or-self::\w+",
    r"(?i)descendant-or-self::\w+",
    r"(?i)following-sibling::\w+",
    r"(?i)preceding-sibling::\w+",
    r"(?i)string-length\s*\(",
    r"(?i)substring\s*\(\s*['\"]",
    r"(?i)substring-before\s*\(",
    r"(?i)substring-after\s*\(",
    r"(?i)translate\s*\(",
    r"(?i)normalize-space\s*\(",
    r"(?i)concat\s*\(",
    r"(?i)starts-with\s*\(",
    r"(?i)contains\s*\(",
    r"(?i)count\s*\(",
    r"(?i)sum\s*\(",
    r"(?i)ceiling\s*\(",
    r"(?i)floor\s*\(",
    r"(?i)round\s*\(",
    r"(?i)not\s*\(",
    r"(?i)true\s*\(\)",
    r"(?i)false\s*\(\)",
    r"(?i)lang\s*\(",
    r"(?i)number\s*\(",
    r"(?i)boolean\s*\(",
    r"(?i)string\s*\(",
    r"(?i)name\s*\(",
    r"(?i)namespace-uri\s*\(",
    r"(?i)local-name\s*\(",
    r"(?i)id\s*\(",
    # NoSQL Injection
    r"(?i)\$gt\s*:",
    r"(?i)\$gte\s*:",
    r"(?i)\$lt\s*:",
    r"(?i)\$lte\s*:",
    r"(?i)\$ne\s*:",
    r"(?i)\$nin\s*:",
    r"(?i)\$in\s*:",
    r"(?i)\$exists\s*:",
    r"(?i)\$regex\s*:",
    r"(?i)\$type\s*:",
    r"(?i)\$mod\s*:",
    r"(?i)\$all\s*:",
    r"(?i)\$size\s*:",
    r"(?i)\$elemMatch\s*:",
    r"(?i)\$or\s*:",
    r"(?i)\$and\s*:",
    r"(?i)\$not\s*:",
    r"(?i)\$nor\s*:",
    r"(?i)\$where\s*:",
    r"(?i)\$expr\s*:",
    r"(?i)\$text\s*:",
    r"(?i)\$search\s*:",
    r"(?i)\$near\s*:",
    r"(?i)\$nearSphere\s*:",
    r"(?i)\$geoIntersects\s*:",
    r"(?i)\$geoWithin\s*:",
    r"(?i)\$lookup\s*:",
    r"(?i)\$unwind\s*:",
    r"(?i)\$group\s*:",
    r"(?i)\$project\s*:",
    r"(?i)\$match\s*:",
    r"(?i)\$sort\s*:",
    r"(?i)\$limit\s*:",
    r"(?i)\$skip\s*:",
    r"(?i)\$redact\s*:",
    r"(?i)\$sample\s*:",
    r"(?i)\$facet\s*:",
    r"(?i)\$bucket\s*:",
    r"(?i)\$bucketAuto\s*:",
    r"(?i)\$addFields\s*:",
    r"(?i)\$replaceRoot\s*:",
    r"(?i)\$merge\s*:",
    r"(?i)\$out\s*:",
    r"(?i)\$currentOp\s*:",
    r"(?i)\$collStats\s*:",
    r"(?i)\$indexStats\s*:",
    r"(?i)\$planCacheStats\s*:",
    r"(?i)\$listSessions\s*:",
    r"(?i)db\.\w+\.find\b",
    r"(?i)db\.\w+\.findOne\b",
    r"(?i)db\.\w+\.update\b",
    r"(?i)db\.\w+\.insert\b",
    r"(?i)db\.\w+\.delete\b",
    r"(?i)db\.\w+\.remove\b",
    r"(?i)db\.\w+\.drop\b",
    r"(?i)db\.\w+\.aggregate\b",
    r"(?i)db\.\w+\.mapReduce\b",
    r"(?i)db\.\w+\.createIndex\b",
    r"(?i)db\.\w+\.dropIndex\b",
    r"(?i)db\.\w+\.getIndexes\b",
    r"(?i)db\.\w+\.stats\b",
    r"(?i)db\.\w+\.count\b",
    r"(?i)db\.\w+\.distinct\b",
    r"(?i)db\.\w+\.explain\b",
    r"(?i)db\.\w+\.validate\b",
    r"(?i)db\.adminCommand\b",
    r"(?i)db\.getSiblingDB\b",
    r"(?i)db\.getCollection\b",
    r"(?i)db\.runCommand\b",
    r"(?i)db\.currentOp\b",
    r"(?i)db\.killOp\b",
    r"(?i)db\.fsyncLock\b",
    r"(?i)db\.fsyncUnlock\b",
    r"(?i)db\.auth\b",
    r"(?i)db\.createUser\b",
    r"(?i)db\.dropUser\b",
    r"(?i)db\.updateUser\b",
    r"(?i)db\.grantRolesToUser\b",
    r"(?i)db\.revokeRolesFromUser\b",
    r"(?i)db\.getUsers\b",
    r"(?i)db\.getRoles\b",
    r"(?i)db\.serverStatus\b",
    r"(?i)db\.hostInfo\b",
    r"(?i)db\.serverBuildInfo\b",
    r"(?i)db\.listCommands\b",
]

# ============================================================================
# 5. HTTP SMUGGLING / CACHE POISONING / HOST HEADER DEEP (200 patterns)
# ============================================================================
HTTP_ABUSE_DEEP = [
    # HTTP Request Smuggling
    r"(?i)Transfer-Encoding\s*:\s*chunked",
    r"(?i)Transfer-Encoding\s*:\s*\bchunked\b\s*,\s*\w+",
    r"(?i)Transfer-Encoding\s*:\s*\w+\s*,\s*\bchunked\b",
    r"(?i)Transfer-Encoding\s*:\s*identity",
    r"(?i)Transfer-Encoding\s*:\s*compress",
    r"(?i)Transfer-Encoding\s*:\s*deflate",
    r"(?i)Transfer-Encoding\s*:\s*gzip",
    r"(?i)Transfer-Encoding\s*:\s*x-chunked",
    r"(?i)Transfer-Encoding\s*:\s*x-gzip",
    r"(?i)Transfer-Encoding\s*:\s*cow",
    r"(?i)Transfer-Encoding\s*:\s*\bchunked\b\r?\n\s*Transfer-Encoding",
    r"(?i)Transfer-Encoding\s*:\s*[\t\x0b]+chunked",
    r"(?i)Transfer-encoding\s*:\s*chunked",
    r"(?i)TRANSFER-ENCODING\s*:\s*chunked",
    r"(?i)Transfer\s*-\s*Encoding\s*:\s*chunked",
    r"(?i)Transfer-Encoding\s+:\s*chunked",
    r"(?i)Transfer-Encoding:\s*chunked\s+",
    r"(?i)Content-Length\s*:\s*\d+\r?\n.*Content-Length\s*:\s*\d+",
    r"(?i)Content-Length\s*:\s*-\d+",
    r"(?i)Content-Length\s*:\s*0\s*\r?\n.*\r?\n\s*(?:GET|POST|PUT|DELETE|PATCH|HEAD|OPTIONS|TRACE|CONNECT)\s+/",
    r"(?i)0\r?\n\r?\n(?:GET|POST|PUT|DELETE|PATCH|HEAD|OPTIONS|TRACE|CONNECT)\s+/",
    # --- H2 desync ---
    r"(?i):method\s+(?:GET|POST|PUT|DELETE|PATCH)\s*\r?\n.*:path\s+/.*\r?\n.*content-length\s*:\s*\d+",
    r"(?i):method\s+(?:GET|POST|PUT|DELETE|PATCH)\s*\r?\n.*transfer-encoding\s*:\s*chunked",
    # Host Header Attacks
    r"(?i)Host\s*:\s*\d+\.\d+\.\d+\.\d+",
    r"(?i)Host\s*:\s*localhost\b",
    r"(?i)Host\s*:\s*127\.0\.0\.1\b",
    r"(?i)Host\s*:\s*0\.0\.0\.0\b",
    r"(?i)Host\s*:\s*\[::1\]",
    r"(?i)Host\s*:\s*\[0:0:0:0:0:0:0:1\]",
    r"(?i)Host\s*:\s*169\.254\.169\.254\b",
    r"(?i)Host\s*:\s*metadata\.google\.internal\b",
    r"(?i)Host\s*:\s*\w+\.burpcollaborator\.net\b",
    r"(?i)Host\s*:\s*\w+\.oastify\.com\b",
    r"(?i)Host\s*:\s*\w+\.interact\.sh\b",
    r"(?i)Host\s*:\s*\w+\.dnslog\.cn\b",
    r"(?i)Host\s*:\s*\w+\.ceye\.io\b",
    r"(?i)X-Forwarded-Host\s*:\s*\w+",
    r"(?i)X-Forwarded-Server\s*:\s*\w+",
    r"(?i)X-Original-URL\s*:\s*/",
    r"(?i)X-Rewrite-URL\s*:\s*/",
    r"(?i)X-Custom-IP-Authorization\s*:\s*127\.0\.0\.1",
    r"(?i)X-Original-Remote-Addr\s*:\s*127\.0\.0\.1",
    r"(?i)X-Originating-IP\s*:\s*127\.0\.0\.1",
    r"(?i)X-Cluster-Client-IP\s*:\s*127\.0\.0\.1",
    r"(?i)True-Client-IP\s*:\s*127\.0\.0\.1",
    r"(?i)Forwarded\s*:\s*for=127\.0\.0\.1",
    r"(?i)X-ProxyUser-Ip\s*:\s*127\.0\.0\.1",
    r"(?i)CF-Connecting-IP\s*:\s*127\.0\.0\.1",
    r"(?i)Fastly-Client-IP\s*:\s*127\.0\.0\.1",
    r"(?i)X-Azure-ClientIP\s*:\s*127\.0\.0\.1",
    r"(?i)X-Akamai-Origin-Hop\s*:\s*\w+",
    # Cache Poisoning
    r"(?i)X-Forwarded-Port\s*:\s*\d+",
    r"(?i)X-Forwarded-Proto\s*:\s*(?:http|https)",
    r"(?i)X-Forwarded-Scheme\s*:\s*(?:http|https|nothttps)",
    r"(?i)X-HTTP-Method-Override\s*:\s*(?:POST|PUT|DELETE|PATCH|OPTIONS|TRACE|CONNECT)",
    r"(?i)X-Method-Override\s*:\s*(?:POST|PUT|DELETE|PATCH)",
    r"(?i)X-Override-URL\s*:\s*/",
    r"(?i)X-Original-Method\s*:\s*(?:POST|PUT|DELETE|PATCH)",
    r"(?i)X-HTTP-Destination\s*:\s*http",
    r"(?i)Pragma\s*:\s*akamai-x-cache-on",
    r"(?i)Pragma\s*:\s*akamai-x-cache-remote-on",
    r"(?i)Pragma\s*:\s*akamai-x-get-cache-key",
    r"(?i)Pragma\s*:\s*akamai-x-get-extracted-values",
    r"(?i)Pragma\s*:\s*akamai-x-get-nonces",
    r"(?i)Pragma\s*:\s*akamai-x-get-request-id",
    r"(?i)Pragma\s*:\s*akamai-x-get-ssl-client-session-id",
    r"(?i)Pragma\s*:\s*akamai-x-get-true-cache-key",
    r"(?i)Pragma\s*:\s*no-cache\b",
    r"(?i)Cache-Control\s*:\s*no-cache\b",
    r"(?i)Cache-Control\s*:\s*no-store\b",
    r"(?i)Cache-Control\s*:\s*max-age=0",
    r"(?i)Cache-Control\s*:\s*s-maxage=0",
    r"(?i)Vary\s*:\s*(?:Origin|User-Agent|Accept-Encoding|Cookie|X-Forwarded-Host)",
    r"(?i)Surrogate-Control\s*:\s*no-store",
    r"(?i)CDN-Loop\s*:\s*\w+",
    r"(?i)X-Cache\s*:\s*(?:HIT|MISS|BYPASS|STALE|UPDATING|REVALIDATED)",
    r"(?i)X-Cache-Status\s*:\s*(?:HIT|MISS|BYPASS|STALE|UPDATING|REVALIDATED)",
    # CRLF Injection
    r"(?i)%0d%0a",
    r"(?i)%0D%0A",
    r"(?i)%0d%0aSet-Cookie:",
    r"(?i)%0d%0aLocation:",
    r"(?i)%0d%0aContent-Type:",
    r"(?i)%0d%0aContent-Length:",
    r"(?i)%0d%0aX-XSS-Protection:",
    r"(?i)%0d%0aX-Content-Type-Options:",
    r"(?i)%0d%0aAccess-Control-Allow-Origin:",
    r"(?i)%0d%0aX-Frame-Options:",
    r"(?i)%0d%0aContent-Security-Policy:",
    r"(?i)%0d%0aStrict-Transport-Security:",
    r"(?i)\r\nSet-Cookie:",
    r"(?i)\r\nLocation:",
    r"(?i)\r\nContent-Type:",
    r"(?i)\r\nContent-Length:",
    r"(?i)\\r\\nSet-Cookie:",
    r"(?i)\\r\\nLocation:",
    r"(?i)\\r\\nContent-Type:",
    r"(?i)\\r\\nContent-Length:",
    r"(?i)%E5%98%8A%E5%98%8D",
    r"(?i)%c0%8d%c0%8a",
    r"(?i)\x0d\x0a",
    # --- Verb Tampering ---
    r"(?i)^(?:TRACE|TRACK|OPTIONS|DEBUG|CONNECT|PROPFIND|PROPPATCH|MKCOL|COPY|MOVE|LOCK|UNLOCK|SEARCH|SUBSCRIBE|UNSUBSCRIBE|PATCH|PURGE|LINK|UNLINK|REPORT|MKACTIVITY|CHECKOUT|MERGE|M-SEARCH|NOTIFY|ACL|BASELINE-CONTROL|BIND|LABEL|ORDERPATCH|REBIND|UNCHECKOUT|UNBIND|UPDATE|VERSION-CONTROL)\s+/",
    r"(?i)^TRACE\s+/",
    r"(?i)^TRACK\s+/",
    r"(?i)^DEBUG\s+/",
    r"(?i)^CONNECT\s+/",
    r"(?i)^PROPFIND\s+/",
    r"(?i)^PROPPATCH\s+/",
    r"(?i)^MKCOL\s+/",
    r"(?i)^COPY\s+/",
    r"(?i)^MOVE\s+/",
    r"(?i)^LOCK\s+/",
    r"(?i)^UNLOCK\s+/",
    r"(?i)^SEARCH\s+/",
    r"(?i)^SUBSCRIBE\s+/",
    r"(?i)^UNSUBSCRIBE\s+/",
    r"(?i)^PATCH\s+/",
    r"(?i)^PURGE\s+/",
    r"(?i)^LINK\s+/",
    r"(?i)^UNLINK\s+/",
    r"(?i)^REPORT\s+/",
    r"(?i)^NOTIFY\s+/",
    r"(?i)^M-SEARCH\s+/",
    r"(?i)^ACL\s+/",
    # --- Request Smuggling via WebSocket ---
    r"(?i)Upgrade\s*:\s*websocket\b.*\r?\nConnection\s*:\s*upgrade\b",
    r"(?i)Sec-WebSocket-Key\s*:\s*[a-zA-Z0-9+/=]+",
    r"(?i)Sec-WebSocket-Version\s*:\s*\d+",
    r"(?i)Sec-WebSocket-Protocol\s*:\s*\w+",
    r"(?i)Sec-WebSocket-Extensions\s*:\s*\w+",
]

# ============================================================================
# 6. API ENDPOINT ENUMERATION DEEP (200 patterns)
# ============================================================================
API_ENDPOINT_DEEP = [
    r"(?i)/api/v\d+/admin\b",
    r"(?i)/api/v\d+/users\b",
    r"(?i)/api/v\d+/user\b",
    r"(?i)/api/v\d+/accounts\b",
    r"(?i)/api/v\d+/account\b",
    r"(?i)/api/v\d+/auth\b",
    r"(?i)/api/v\d+/login\b",
    r"(?i)/api/v\d+/token\b",
    r"(?i)/api/v\d+/tokens\b",
    r"(?i)/api/v\d+/session\b",
    r"(?i)/api/v\d+/sessions\b",
    r"(?i)/api/v\d+/keys\b",
    r"(?i)/api/v\d+/apikeys\b",
    r"(?i)/api/v\d+/webhooks\b",
    r"(?i)/api/v\d+/settings\b",
    r"(?i)/api/v\d+/config\b",
    r"(?i)/api/v\d+/configuration\b",
    r"(?i)/api/v\d+/internal\b",
    r"(?i)/api/v\d+/private\b",
    r"(?i)/api/v\d+/debug\b",
    r"(?i)/api/v\d+/test\b",
    r"(?i)/api/v\d+/health\b",
    r"(?i)/api/v\d+/(?:debug|console|phpinfo|shell|backdoor|eval)\b",
    r"(?i)/api/v\d+/info\b",
    r"(?i)/api/v\d+/metrics\b",
    r"(?i)/api/v\d+/stats\b",
    r"(?i)/api/v\d+/analytics\b",
    r"(?i)/api/v\d+/logs\b",
    r"(?i)/api/v\d+/audit\b",
    r"(?i)/api/v\d+/roles\b",
    r"(?i)/api/v\d+/permissions\b",
    r"(?i)/api/v\d+/groups\b",
    r"(?i)/api/v\d+/organizations\b",
    r"(?i)/api/v\d+/tenants\b",
    r"(?i)/api/v\d+/billing\b",
    r"(?i)/api/v\d+/payments\b",
    r"(?i)/api/v\d+/subscriptions\b",
    r"(?i)/api/v\d+/orders\b",
    r"(?i)/api/v\d+/products\b",
    r"(?i)/api/v\d+/inventory\b",
    r"(?i)/api/v\d+/files\b",
    r"(?i)/api/v\d+/uploads\b",
    r"(?i)/api/v\d+/downloads\b",
    r"(?i)/api/v\d+/export\b",
    r"(?i)/api/v\d+/import\b",
    r"(?i)/api/v\d+/backup\b",
    r"(?i)/api/v\d+/restore\b",
    r"(?i)/api/v\d+/database\b",
    r"(?i)/api/v\d+/query\b",
    r"(?i)/api/v\d+/search\b",
    r"(?i)/api/v\d+/graphql\b",
    # Spring Boot Actuator
    r"(?i)/actuator\b",
    r"(?i)/actuator/beans\b",
    r"(?i)/actuator/caches\b",
    r"(?i)/actuator/conditions\b",
    r"(?i)/actuator/configprops\b",
    r"(?i)/actuator/env\b",
    r"(?i)/actuator/flyway\b",
    r"(?i)/actuator/health\b",
    r"(?i)/actuator/heapdump\b",
    r"(?i)/actuator/httptrace\b",
    r"(?i)/actuator/info\b",
    r"(?i)/actuator/integrationgraph\b",
    r"(?i)/actuator/jolokia\b",
    r"(?i)/actuator/logfile\b",
    r"(?i)/actuator/loggers\b",
    r"(?i)/actuator/liquibase\b",
    r"(?i)/actuator/mappings\b",
    r"(?i)/actuator/metrics\b",
    r"(?i)/actuator/prometheus\b",
    r"(?i)/actuator/scheduledtasks\b",
    r"(?i)/actuator/sessions\b",
    r"(?i)/actuator/shutdown\b",
    r"(?i)/actuator/startup\b",
    r"(?i)/actuator/threaddump\b",
    # --- Admin panels ---
    r"(?i)/phpmyadmin\b",
    r"(?i)/pma\b",
    r"(?i)/myadmin\b",
    r"(?i)/mysql\b",
    r"(?i)/mysqladmin\b",
    r"(?i)/sql\b",
    r"(?i)/adminer\b",
    r"(?i)/dbadmin\b",
    r"(?i)/phpPgAdmin\b",
    r"(?i)/pgadmin\b",
    r"(?i)/phppgadmin\b",
    r"(?i)/mongo-express\b",
    r"(?i)/redis-commander\b",
    r"(?i)/elasticsearch-head\b",
    r"(?i)/kibana\b",
    r"(?i)/grafana\b",
    r"(?i)/prometheus\b",
    r"(?i)/jaeger\b",
    r"(?i)/zipkin\b",
    r"(?i)/consul\b",
    r"(?i)/vault\b",
    r"(?i)/nomad\b",
    r"(?i)/traefik\b",
    r"(?i)/portainer\b",
    r"(?i)/rancher\b",
    r"(?i)/kubernetes-dashboard\b",
    r"(?i)/dashboard/(?:admin|config|debug|phpinfo|server-status|server-info)\b",
    r"(?i)/manager\b",
    r"(?i)/manager/html\b",
    r"(?i)/manager/text\b",
    r"(?i)/manager/status\b",
    r"(?i)/jmx-console\b",
    r"(?i)/web-console\b",
    r"(?i)/admin-console\b",
    r"(?i)/invoker/\w+\b",
    r"(?i)/jolokia\b",
    r"(?i)/hawtio\b",
    r"(?i)/solr\b",
    r"(?i)/solr/admin\b",
    r"(?i)/jenkins\b",
    r"(?i)/jenkins/script\b",
    r"(?i)/jenkins/api\b",
    r"(?i)/hudson\b",
    r"(?i)/bamboo\b",
    r"(?i)/teamcity\b",
    r"(?i)/sonar\b",
    r"(?i)/sonarqube\b",
    r"(?i)/nexus\b",
    r"(?i)/artifactory\b",
    r"(?i)/harbor\b",
    r"(?i)/registry\b",
    r"(?i)/v2/_catalog\b",
    r"(?i)/v2/\w+/tags/list\b",
    r"(?i)/v2/\w+/manifests/\w+\b",
    r"(?i)/v2/\w+/blobs/\w+\b",
    r"(?i)/swagger\b",
    r"(?i)/swagger-ui\b",
    r"(?i)/swagger-ui\.html\b",
    r"(?i)/swagger-resources\b",
    r"(?i)/api-docs\b",
    r"(?i)/openapi\b",
    r"(?i)/openapi\.json\b",
    r"(?i)/openapi\.yaml\b",
    r"(?i)/redoc\b",
    r"(?i)^/docs/?(?:\?|$)",
    r"(?i)/graphiql\b",
    r"(?i)/playground\b",
    r"(?i)/altair\b",
    r"(?i)/voyager\b",
    r"(?i)/__graphql\b",
    r"(?i)/\.well-known/\b",
    r"(?i)/\.well-known/openid-configuration\b",
    r"(?i)/\.well-known/jwks\.json\b",
    r"(?i)/\.well-known/security\.txt\b",
    r"(?i)/\.well-known/assetlinks\.json\b",
    r"(?i)/\.well-known/apple-app-site-association\b",
    r"(?i)/server-status\b",
    r"(?i)/server-info\b",
    r"(?i)^/status(?:/|\?|$)",
    r"(?i)/debug/\b",
    r"(?i)/debug/default/\b",
    r"(?i)/debug/pprof\b",
    r"(?i)/debug/vars\b",
    r"(?i)/debug/requests\b",
    r"(?i)/debug/events\b",
    r"(?i)/trace\b",
    r"(?i)/metrics\b",
    r"(?i)/healthz\b",
    r"(?i)/readyz\b",
    r"(?i)/livez\b",
    r"(?i)/_debug\b",
    r"(?i)/_status\b",
    r"(?i)/_health\b",
    r"(?i)/_monitoring\b",
    r"(?i)/_cluster\b",
    r"(?i)/_nodes\b",
    r"(?i)/_cat\b",
    r"(?i)/_mapping\b",
    r"(?i)/_search\b",
    r"(?i)/_all\b",
    r"(?i)/_analyze\b",
    r"(?i)/_template\b",
    r"(?i)/_snapshot\b",
    r"(?i)/_tasks\b",
    r"(?i)/_ingest\b",
    r"(?i)/_reindex\b",
    r"(?i)/_update_by_query\b",
    r"(?i)/_delete_by_query\b",
]

# ============================================================================
# 7. WINDOWS-SPECIFIC ATTACK PATTERNS (200 patterns)
# ============================================================================
WINDOWS_ATTACKS = [
    r"(?i)\bcmd\s*/c\b",
    r"(?i)\bcmd\s*/k\b",
    r"(?i)\bcmd\s*/r\b",
    r"(?i)\bcmd\.exe\s*/c\b",
    r"(?i)\bcmd\.exe\s*/k\b",
    r"(?i)\bpowershell\s+-(?:e|enc|encoded|encodedcommand)\b",
    r"(?i)\bpowershell\s+-(?:exec|executionpolicy)\s+bypass\b",
    r"(?i)\bpowershell\s+-(?:nop|noprofile)\b",
    r"(?i)\bpowershell\s+-(?:sta|w\s+hidden|windowstyle\s+hidden)\b",
    r"(?i)\bpowershell\s+-(?:c|command)\b",
    r"(?i)\bpowershell\s+(?:IEX|Invoke-Expression)\b",
    r"(?i)\bpowershell\s+(?:ICM|Invoke-Command)\b",
    r"(?i)\bpowershell\s+(?:IWR|Invoke-WebRequest)\b",
    r"(?i)\bpowershell\s+(?:Invoke-RestMethod)\b",
    r"(?i)\bpowershell\s+(?:Start-Process)\b",
    r"(?i)\bpowershell\s+(?:Start-Job)\b",
    r"(?i)\bpowershell\s+(?:New-Object)\s+(?:Net\.WebClient|System\.Net\.WebClient)\b",
    r"(?i)\bpowershell\s+(?:New-Object)\s+(?:IO\.StreamReader|System\.IO\.StreamReader)\b",
    r"(?i)\bpowershell\s+(?:New-Object)\s+(?:IO\.MemoryStream|System\.IO\.MemoryStream)\b",
    r"(?i)\bpowershell\s+\[System\.Convert\]::FromBase64String\b",
    r"(?i)\bpowershell\s+\[System\.Text\.Encoding\]::\w+\.GetString\b",
    r"(?i)\bpowershell\s+\[System\.IO\.File\]::\w+\b",
    r"(?i)\bpowershell\s+\[System\.Reflection\.Assembly\]::Load\b",
    r"(?i)\bpowershell\s+Add-Type\b",
    r"(?i)\bpowershell\s+Import-Module\b",
    r"(?i)\bpowershell\s+Get-Content\b",
    r"(?i)\bpowershell\s+Set-Content\b",
    r"(?i)\bpowershell\s+Out-File\b",
    r"(?i)\bpowershell\s+Copy-Item\b",
    r"(?i)\bpowershell\s+Move-Item\b",
    r"(?i)\bpowershell\s+Remove-Item\b",
    r"(?i)\bpowershell\s+Get-Process\b",
    r"(?i)\bpowershell\s+Stop-Process\b",
    r"(?i)\bpowershell\s+Get-Service\b",
    r"(?i)\bpowershell\s+Start-Service\b",
    r"(?i)\bpowershell\s+Stop-Service\b",
    r"(?i)\bpowershell\s+Get-EventLog\b",
    r"(?i)\bpowershell\s+Clear-EventLog\b",
    r"(?i)\bpowershell\s+Get-WmiObject\b",
    r"(?i)\bpowershell\s+Get-CimInstance\b",
    r"(?i)\bpowershell\s+Invoke-WmiMethod\b",
    r"(?i)\bpowershell\s+Invoke-CimMethod\b",
    r"(?i)\bpowershell\s+Get-ItemProperty\b",
    r"(?i)\bpowershell\s+Set-ItemProperty\b",
    r"(?i)\bpowershell\s+New-ItemProperty\b",
    r"(?i)\bpowershell\s+Remove-ItemProperty\b",
    r"(?i)\bpowershell\s+Get-ChildItem\b",
    r"(?i)\bpowershell\s+Test-Path\b",
    r"(?i)\bpowershell\s+New-Item\b",
    r"(?i)\bpowershell\s+Get-Acl\b",
    r"(?i)\bpowershell\s+Set-Acl\b",
    r"(?i)\bpowershell\s+Get-LocalUser\b",
    r"(?i)\bpowershell\s+New-LocalUser\b",
    r"(?i)\bpowershell\s+Get-LocalGroup\b",
    r"(?i)\bpowershell\s+Add-LocalGroupMember\b",
    r"(?i)\bpowershell\s+Get-ADUser\b",
    r"(?i)\bpowershell\s+Get-ADComputer\b",
    r"(?i)\bpowershell\s+Get-ADGroup\b",
    r"(?i)\bpowershell\s+Get-ADDomain\b",
    r"(?i)\bpowershell\s+Get-ADForest\b",
    r"(?i)\bpowershell\s+Get-ADGroupMember\b",
    r"(?i)\bpowershell\s+Get-ADPrincipalGroupMembership\b",
    r"(?i)\bpowershell\s+Get-ADTrust\b",
    r"(?i)\bpowershell\s+Get-DomainPolicy\b",
    r"(?i)\bpowershell\s+Get-NetDomain\b",
    r"(?i)\bpowershell\s+Get-NetComputer\b",
    r"(?i)\bpowershell\s+Get-NetUser\b",
    r"(?i)\bpowershell\s+Get-NetGroup\b",
    r"(?i)\bpowershell\s+Get-NetSession\b",
    r"(?i)\bpowershell\s+Get-NetLoggedon\b",
    r"(?i)\bpowershell\s+Invoke-ShareFinder\b",
    r"(?i)\bpowershell\s+Invoke-FileFinder\b",
    r"(?i)\bpowershell\s+Find-LocalAdminAccess\b",
    r"(?i)\bpowershell\s+Get-NetGPO\b",
    r"(?i)\bpowershell\s+Get-ObjectAcl\b",
    r"(?i)\bpowershell\s+Find-InterestingDomainAcl\b",
    r"(?i)\bpowershell\s+Invoke-ACLScanner\b",
    r"(?i)\bpowershell\s+Invoke-BloodHound\b",
    r"(?i)\bpowershell\s+Invoke-Mimikatz\b",
    r"(?i)\bpowershell\s+Invoke-Kerberoast\b",
    r"(?i)\bpowershell\s+Invoke-ASREPRoast\b",
    r"(?i)\bpowershell\s+Invoke-TokenManipulation\b",
    r"(?i)\bpowershell\s+Invoke-CredentialInjection\b",
    r"(?i)\bpowershell\s+Enable-PSRemoting\b",
    r"(?i)\bpowershell\s+Enter-PSSession\b",
    r"(?i)\bpowershell\s+New-PSSession\b",
    r"(?i)\bpowershell\s+Invoke-PSRemoting\b",
    r"(?i)\bpowershell\s+DownloadString\b",
    r"(?i)\bpowershell\s+DownloadFile\b",
    r"(?i)\bpowershell\s+DownloadData\b",
    # --- Windows commands ---
    r"(?i)\bwhoami\s+/all\b",
    r"(?i)\bwhoami\s+/priv\b",
    r"(?i)\bwhoami\s+/groups\b",
    r"(?i)\bnet\s+user\b",
    r"(?i)\bnet\s+user\s+/add\b",
    r"(?i)\bnet\s+localgroup\b",
    r"(?i)\bnet\s+localgroup\s+administrators\b",
    r"(?i)\bnet\s+group\b",
    r"(?i)\bnet\s+group\s+/domain\b",
    r"(?i)\bnet\s+share\b",
    r"(?i)\bnet\s+use\b",
    r"(?i)\bnet\s+view\b",
    r"(?i)\bnet\s+session\b",
    r"(?i)\bnet\s+start\b",
    r"(?i)\bnet\s+stop\b",
    r"(?i)\bnet\s+accounts\b",
    r"(?i)\bnet\s+config\b",
    r"(?i)\bnet\s+statistics\b",
    r"(?i)\bnet\s+time\b",
    r"(?i)\bipconfig\s+/all\b",
    r"(?i)\bipconfig\s+/displaydns\b",
    r"(?i)\bipconfig\s+/flushdns\b",
    r"(?i)\bsysteminfo\b",
    r"(?i)\btasklist\b",
    r"(?i)\btasklist\s+/svc\b",
    r"(?i)\btasklist\s+/v\b",
    r"(?i)\btaskkill\b",
    r"(?i)\bnetstat\s+-an\b",
    r"(?i)\bnetstat\s+-ano\b",
    r"(?i)\bnetstat\s+-anob\b",
    r"(?i)\bnetsh\s+advfirewall\b",
    r"(?i)\bnetsh\s+firewall\b",
    r"(?i)\bnetsh\s+interface\b",
    r"(?i)\bnetsh\s+wlan\b",
    r"(?i)\bsc\s+query\b",
    r"(?i)\bsc\s+create\b",
    r"(?i)\bsc\s+delete\b",
    r"(?i)\bsc\s+start\b",
    r"(?i)\bsc\s+stop\b",
    r"(?i)\bsc\s+config\b",
    r"(?i)\breg\s+query\b",
    r"(?i)\breg\s+add\b",
    r"(?i)\breg\s+delete\b",
    r"(?i)\breg\s+export\b",
    r"(?i)\breg\s+import\b",
    r"(?i)\breg\s+save\b",
    r"(?i)\breg\s+restore\b",
    r"(?i)\bschtasks\s+/create\b",
    r"(?i)\bschtasks\s+/delete\b",
    r"(?i)\bschtasks\s+/query\b",
    r"(?i)\bschtasks\s+/run\b",
    r"(?i)\bwmic\s+process\b",
    r"(?i)\bwmic\s+service\b",
    r"(?i)\bwmic\s+os\b",
    r"(?i)\bwmic\s+useraccount\b",
    r"(?i)\bwmic\s+group\b",
    r"(?i)\bwmic\s+qfe\b",
    r"(?i)\bwmic\s+startup\b",
    r"(?i)\bwmic\s+share\b",
    r"(?i)\bwmic\s+product\b",
    r"(?i)\bwmic\s+logicaldisk\b",
    r"(?i)\bwmic\s+computersystem\b",
    r"(?i)\bwmic\s+shadowcopy\b",
    r"(?i)\bwmic\s+nic\b",
    r"(?i)\bwmic\s+nicconfig\b",
    r"(?i)\bcertutil\s+-urlcache\b",
    r"(?i)\bcertutil\s+-decode\b",
    r"(?i)\bcertutil\s+-encode\b",
    r"(?i)\bcertutil\s+-hashfile\b",
    r"(?i)\bbitsadmin\s+/transfer\b",
    r"(?i)\bbitsadmin\s+/create\b",
    r"(?i)\bbitsadmin\s+/addfile\b",
    r"(?i)\bbitsadmin\s+/resume\b",
    r"(?i)\bbitsadmin\s+/complete\b",
    r"(?i)\bmshta\s+http",
    r"(?i)\bmshta\s+javascript:",
    r"(?i)\bmshta\s+vbscript:",
    r"(?i)\brundll32\b",
    r"(?i)\bregsvr32\b",
    r"(?i)\bcscript\b",
    r"(?i)\bwscript\b",
    r"(?i)\binstallutil\b",
    r"(?i)\bregasm\b",
    r"(?i)\bregsvcs\b",
    r"(?i)\bmsbuild\b",
    r"(?i)\baspnet_compiler\b",
    r"(?i)\bcsc\.exe\b",
    r"(?i)\bvbc\.exe\b",
    r"(?i)\bjsc\.exe\b",
    r"(?i)\bmsxsl\.exe\b",
    r"(?i)\bieexec\.exe\b",
    r"(?i)\bcontrol\.exe\b",
    r"(?i)\bpresentationhost\.exe\b",
    r"(?i)\bdfsvc\.exe\b",
    r"(?i)\binfdefaultinstall\.exe\b",
    r"(?i)\bmavinject\.exe\b",
    r"(?i)\bsyncappvpublishingserver\.exe\b",
    r"(?i)\bodpkg\.exe\b",
    r"(?i)\bpcwrun\.exe\b",
    r"(?i)\bftp\s+-s\b",
    r"(?i)\bvssadmin\s+(?:list|create|delete|resize)\b",
    r"(?i)\bntdsutil\b",
    r"(?i)\bdsquery\b",
    r"(?i)\bdsget\b",
    r"(?i)\bdsmod\b",
    r"(?i)\bdcpromo\b",
    r"(?i)\bprocdump\b",
    r"(?i)\bcomsvcs\.dll\b.*MiniDump",
]


RULES_MEGA_8_MAP = {
    'wordpress_deep': WORDPRESS_DEEP,
    'cms_other_deep': CMS_OTHER_DEEP,
    'xxe_deep': XXE_DEEP,
    'injection_deep': INJECTION_DEEP,
    'http_abuse_deep': HTTP_ABUSE_DEEP,
    'api_endpoint_deep': API_ENDPOINT_DEEP,
    'windows_attacks': WINDOWS_ATTACKS,
}


def get_all_mega8_patterns():
    for category, patterns in RULES_MEGA_8_MAP.items():
        for regex_str in patterns:
            yield (regex_str, category)


def count_mega8_patterns():
    return sum(len(p) for p in RULES_MEGA_8_MAP.values())
