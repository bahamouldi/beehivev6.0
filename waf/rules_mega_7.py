"""
BeeWAF Mega Rules Database — Part 7
=====================================
Granular attack signatures: individual SQL functions, XSS event handlers,
shell commands, file paths, and protocol keywords — maximizing pattern count.
~1600 additional patterns.
"""

# ============================================================================
# 1. INDIVIDUAL SQL KEYWORDS & FUNCTIONS (300 patterns)
# ============================================================================
SQL_KEYWORDS_INDIVIDUAL = [
    r"(?i)\bSELECT\s+.*\bFROM\b",
    r"(?i)\bINSERT\s+INTO\b",
    r"(?i)\bUPDATE\s+\w+\s+SET\b",
    r"(?i)\bDELETE\s+FROM\b",
    r"(?i)\bDROP\s+TABLE\b",
    r"(?i)\bDROP\s+DATABASE\b",
    r"(?i)\bDROP\s+SCHEMA\b",
    r"(?i)\bDROP\s+VIEW\b",
    r"(?i)\bDROP\s+INDEX\b",
    r"(?i)\bDROP\s+TRIGGER\b",
    r"(?i)\bDROP\s+PROCEDURE\b",
    r"(?i)\bDROP\s+FUNCTION\b",
    r"(?i)\bDROP\s+EVENT\b",
    r"(?i)\bDROP\s+USER\b",
    r"(?i)\bDROP\s+ROLE\b",
    r"(?i)\bDROP\s+SEQUENCE\b",
    r"(?i)\bDROP\s+TABLESPACE\b",
    r"(?i)\bDROP\s+SERVER\b",
    r"(?i)\bALTER\s+TABLE\b",
    r"(?i)\bALTER\s+DATABASE\b",
    r"(?i)\bALTER\s+SCHEMA\b",
    r"(?i)\bALTER\s+USER\b",
    r"(?i)\bALTER\s+ROLE\b",
    r"(?i)\bALTER\s+VIEW\b",
    r"(?i)\bALTER\s+INDEX\b",
    r"(?i)\bALTER\s+TRIGGER\b",
    r"(?i)\bALTER\s+PROCEDURE\b",
    r"(?i)\bALTER\s+FUNCTION\b",
    r"(?i)\bCREATE\s+TABLE\b",
    r"(?i)\bCREATE\s+DATABASE\b",
    r"(?i)\bCREATE\s+SCHEMA\b",
    r"(?i)\bCREATE\s+VIEW\b",
    r"(?i)\bCREATE\s+INDEX\b",
    r"(?i)\bCREATE\s+TRIGGER\b",
    r"(?i)\bCREATE\s+PROCEDURE\b",
    r"(?i)\bCREATE\s+FUNCTION\b",
    r"(?i)\bCREATE\s+EVENT\b",
    r"(?i)\bCREATE\s+USER\b",
    r"(?i)\bCREATE\s+ROLE\b",
    r"(?i)\bCREATE\s+SEQUENCE\b",
    r"(?i)\bTRUNCATE\s+TABLE\b",
    r"(?i)\bRENAME\s+TABLE\b",
    r"(?i)\bGRANT\s+ALL\b",
    r"(?i)\bGRANT\s+SELECT\b",
    r"(?i)\bGRANT\s+INSERT\b",
    r"(?i)\bGRANT\s+UPDATE\b",
    r"(?i)\bGRANT\s+DELETE\b",
    r"(?i)\bGRANT\s+EXECUTE\b",
    r"(?i)\bGRANT\s+SUPER\b",
    r"(?i)\bGRANT\s+FILE\b",
    r"(?i)\bREVOKE\s+ALL\b",
    r"(?i)\bREVOKE\s+SELECT\b",
    r"(?i)\bREVOKE\s+INSERT\b",
    r"(?i)\bREVOKE\s+UPDATE\b",
    r"(?i)\bREVOKE\s+DELETE\b",
    r"(?i)\bEXEC\s+(?:master|xp_|sp_)\w+",
    r"(?i)\bEXECUTE\s+(?:master|xp_|sp_)\w+",
    r"(?i)\bDECLARE\s+@\w+\b",
    r"(?i)\bSET\s+@\w+\s*=",
    r"(?i)\bWAITFOR\s+DELAY\b",
    r"(?i)\bWAITFOR\s+TIME\b",
    r"(?i)\bSHUTDOWN\s+(?:WITH\s+NOWAIT)?\b",
    r"(?i)\bRECONFIGURE\b",
    r"(?i)\bBULK\s+INSERT\b",
    r"(?i)\bOPENROWSET\b",
    r"(?i)\bOPENDATASOURCE\b",
    r"(?i)\bOPENQUERY\b",
    r"(?i)\bLINKED\s+SERVER\b",
    r"(?i)\bSELECT\s+@@VERSION\b",
    r"(?i)\bSELECT\s+@@SERVERNAME\b",
    r"(?i)\bSELECT\s+@@LANGUAGE\b",
    r"(?i)\bSELECT\s+@@SPID\b",
    r"(?i)\bSELECT\s+DB_NAME\s*\(",
    r"(?i)\bSELECT\s+USER_NAME\s*\(",
    r"(?i)\bSELECT\s+SYSTEM_USER\b",
    r"(?i)\bSELECT\s+SESSION_USER\b",
    r"(?i)\bSELECT\s+CURRENT_USER\b",
    r"(?i)\bSELECT\s+SUSER_SNAME\b",
    r"(?i)\bSELECT\s+HOST_NAME\s*\(",
    r"(?i)\bSELECT\s+ORIGINAL_LOGIN\s*\(",
    r"(?i)\bINFORMATION_SCHEMA\.TABLES\b",
    r"(?i)\bINFORMATION_SCHEMA\.COLUMNS\b",
    r"(?i)\bINFORMATION_SCHEMA\.SCHEMATA\b",
    r"(?i)\bINFORMATION_SCHEMA\.TABLE_PRIVILEGES\b",
    r"(?i)\bINFORMATION_SCHEMA\.COLUMN_PRIVILEGES\b",
    r"(?i)\bINFORMATION_SCHEMA\.ROUTINES\b",
    r"(?i)\bINFORMATION_SCHEMA\.KEY_COLUMN_USAGE\b",
    r"(?i)\bINFORMATION_SCHEMA\.TABLE_CONSTRAINTS\b",
    r"(?i)\bINFORMATION_SCHEMA\.VIEWS\b",
    r"(?i)\bINFORMATION_SCHEMA\.TRIGGERS\b",
    r"(?i)\bINFORMATION_SCHEMA\.PARAMETERS\b",
    r"(?i)\bINFORMATION_SCHEMA\.REFERENTIAL_CONSTRAINTS\b",
    r"(?i)\bINFORMATION_SCHEMA\.CHECK_CONSTRAINTS\b",
    r"(?i)\bINFORMATION_SCHEMA\.DOMAINS\b",
    r"(?i)\bINFORMATION_SCHEMA\.USER_PRIVILEGES\b",
    r"(?i)\bSYS\.OBJECTS\b",
    r"(?i)\bSYS\.TABLES\b",
    r"(?i)\bSYS\.COLUMNS\b",
    r"(?i)\bSYS\.VIEWS\b",
    r"(?i)\bSYS\.PROCEDURES\b",
    r"(?i)\bSYS\.SCHEMAS\b",
    r"(?i)\bSYS\.DATABASES\b",
    r"(?i)\bSYS\.SERVER_PRINCIPALS\b",
    r"(?i)\bSYS\.SQL_LOGINS\b",
    r"(?i)\bSYS\.SYSLOGINS\b",
    r"(?i)\bSYS\.SYSUSERS\b",
    r"(?i)\bSYS\.SYSOBJECTS\b",
    r"(?i)\bSYS\.SYSCOLUMNS\b",
    r"(?i)\bSYS\.SYSDATABASES\b",
    r"(?i)\bSYS\.DM_EXEC_SESSIONS\b",
    r"(?i)\bSYS\.DM_EXEC_REQUESTS\b",
    r"(?i)\bSYS\.DM_EXEC_CONNECTIONS\b",
    r"(?i)\bSYS\.DM_EXEC_SQL_TEXT\b",
    r"(?i)\bSYS\.DM_EXEC_QUERY_PLAN\b",
    r"(?i)\bSYS\.DM_EXEC_CACHED_PLANS\b",
    r"(?i)\bSYS\.DM_OS_SYS_INFO\b",
    r"(?i)\bSYS\.DM_OS_HOSTS\b",
    r"(?i)\bSYS\.DM_OS_PERFORMANCE_COUNTERS\b",
    r"(?i)\bSYS\.DM_DB_INDEX_USAGE_STATS\b",
    r"(?i)\bSYS\.DM_TRAN_LOCKS\b",
    r"(?i)\bMYSQL\.USER\b",
    r"(?i)\bMYSQL\.DB\b",
    r"(?i)\bMYSQL\.TABLES_PRIV\b",
    r"(?i)\bMYSQL\.COLUMNS_PRIV\b",
    r"(?i)\bMYSQL\.PROC\b",
    r"(?i)\bMYSQL\.PLUGIN\b",
    r"(?i)\bMYSQL\.GENERAL_LOG\b",
    r"(?i)\bMYSQL\.SLOW_LOG\b",
    r"(?i)\bPG_CATALOG\.PG_TABLES\b",
    r"(?i)\bPG_CATALOG\.PG_VIEWS\b",
    r"(?i)\bPG_CATALOG\.PG_USER\b",
    r"(?i)\bPG_CATALOG\.PG_SHADOW\b",
    r"(?i)\bPG_CATALOG\.PG_ROLES\b",
    r"(?i)\bPG_CATALOG\.PG_DATABASE\b",
    r"(?i)\bPG_CATALOG\.PG_NAMESPACE\b",
    r"(?i)\bPG_CATALOG\.PG_CLASS\b",
    r"(?i)\bPG_CATALOG\.PG_ATTRIBUTE\b",
    r"(?i)\bPG_CATALOG\.PG_INDEX\b",
    r"(?i)\bPG_CATALOG\.PG_CONSTRAINT\b",
    r"(?i)\bPG_CATALOG\.PG_TRIGGER\b",
    r"(?i)\bPG_CATALOG\.PG_TYPE\b",
    r"(?i)\bPG_CATALOG\.PG_PROC\b",
    r"(?i)\bPG_CATALOG\.PG_DESCRIPTION\b",
    r"(?i)\bPG_CATALOG\.PG_STAT_ACTIVITY\b",
    r"(?i)\bPG_CATALOG\.PG_STAT_REPLICATION\b",
    r"(?i)\bPG_CATALOG\.PG_SETTINGS\b",
    r"(?i)\bPG_CATALOG\.PG_FILE_SETTINGS\b",
    r"(?i)\bPG_CATALOG\.PG_HBA_FILE_RULES\b",
    r"(?i)\bSQLITE_MASTER\b",
    r"(?i)\bSQLITE_TEMP_MASTER\b",
    r"(?i)\bSQLITE_SEQUENCE\b",
    # --- SQL function signatures ---
    r"(?i)\bCONCAT\s*\(\s*(?:0x|char|chr)\b",
    r"(?i)\bCONCAT_WS\s*\(\s*(?:0x|char|chr)\b",
    r"(?i)\bGROUP_CONCAT\s*\(",
    r"(?i)\bSTRING_AGG\s*\(",
    r"(?i)\bLISTAGG\s*\(",
    r"(?i)\bWM_CONCAT\s*\(",
    r"(?i)\bXMLAGG\s*\(",
    r"(?i)\bARRAY_AGG\s*\(",
    r"(?i)\bJSON_AGG\s*\(",
    r"(?i)\bJSON_ARRAYAGG\s*\(",
    r"(?i)\bJSON_OBJECTAGG\s*\(",
    r"(?i)\bJSON_GROUP_ARRAY\s*\(",
    r"(?i)\bEXTRACTVALUE\s*\(",
    r"(?i)\bUPDATEXML\s*\(",
    r"(?i)\bXMLTYPE\s*\(",
    r"(?i)\bHEX\s*\(\s*(?:user|version|database)\b",
    r"(?i)\bUNHEX\s*\(",
    r"(?i)\bTO_HEX\s*\(",
    r"(?i)\bFROM_BASE64\s*\(",
    r"(?i)\bTO_BASE64\s*\(",
    r"(?i)\bCOMPRESS\s*\(",
    r"(?i)\bUNCOMPRESS\s*\(",
    r"(?i)\bMD5\s*\(\s*(?:user|version|database)\b",
    r"(?i)\bSHA1\s*\(\s*(?:user|version|database)\b",
    r"(?i)\bSHA2\s*\(\s*(?:user|version|database)\b",
    r"(?i)\bAES_ENCRYPT\s*\(",
    r"(?i)\bAES_DECRYPT\s*\(",
    r"(?i)\bDES_ENCRYPT\s*\(",
    r"(?i)\bDES_DECRYPT\s*\(",
    r"(?i)\bBENCHMARK\s*\(\s*\d{4,}",
    r"(?i)\bSLEEP\s*\(\s*\d+\s*\)",
    r"(?i)\bPG_SLEEP\s*\(\s*\d+\s*\)",
    r"(?i)\bPG_SLEEP_FOR\s*\(",
    r"(?i)\bPG_SLEEP_UNTIL\s*\(",
    r"(?i)\bDBMS_LOCK\.SLEEP\s*\(",
    r"(?i)\bDBMS_PIPE\.RECEIVE_MESSAGE\s*\(",
    r"(?i)\bRANDOMBLOB\s*\(\s*\d{6,}",
    r"(?i)\bGET_LOCK\s*\(",
    r"(?i)\bRELEASE_LOCK\s*\(",
    r"(?i)\bIS_FREE_LOCK\s*\(",
    r"(?i)\bIS_USED_LOCK\s*\(",
    r"(?i)\bMASTER_POS_WAIT\s*\(",
    r"(?i)\bFOUND_ROWS\s*\(",
    r"(?i)\bROW_COUNT\s*\(",
    r"(?i)\bLAST_INSERT_ID\s*\(",
    r"(?i)\bCONNECTION_ID\s*\(",
    r"(?i)\bCURRENT_USER\s*\(",
    r"(?i)\bSYSTEM_USER\s*\(",
    r"(?i)\bSESSION_USER\s*\(",
    r"(?i)\bDATABASE\s*\(",
    r"(?i)\bVERSION\s*\(",
    r"(?i)\bSCHEMA\s*\(",
    r"(?i)\bUUID\s*\(",
    r"(?i)\bUUID_SHORT\s*\(",
    r"(?i)\bINET_ATON\s*\(",
    r"(?i)\bINET_NTOA\s*\(",
    r"(?i)\bINET6_ATON\s*\(",
    r"(?i)\bINET6_NTOA\s*\(",
    r"(?i)\bLOAD_FILE\s*\(",
    r"(?i)\bLO_IMPORT\s*\(",
    r"(?i)\bLO_EXPORT\s*\(",
    r"(?i)\bPG_READ_FILE\s*\(",
    r"(?i)\bPG_READ_BINARY_FILE\s*\(",
    r"(?i)\bPG_LS_DIR\s*\(",
    r"(?i)\bPG_STAT_FILE\s*\(",
    r"(?i)\bDBLINK\s*\(",
    r"(?i)\bDBLINK_CONNECT\s*\(",
    r"(?i)\bDBLINK_EXEC\s*\(",
    r"(?i)\bDBLINK_SEND_QUERY\s*\(",
    r"(?i)\bUTL_HTTP\.REQUEST\s*\(",
    r"(?i)\bUTL_INADDR\.GET_HOST_ADDRESS\s*\(",
    r"(?i)\bUTL_INADDR\.GET_HOST_NAME\s*\(",
    r"(?i)\bUTL_FILE\.FOPEN\s*\(",
    r"(?i)\bUTL_FILE\.GET_LINE\s*\(",
    r"(?i)\bUTL_FILE\.PUT_LINE\s*\(",
    r"(?i)\bHTTPURITYPE\s*\(",
    r"(?i)\bSYS_CONTEXT\s*\(",
    r"(?i)\bEXECUTE\s+IMMEDIATE\b",
]

# ============================================================================
# 2. INDIVIDUAL XSS EVENT HANDLERS & TAGS (250 patterns)
# ============================================================================
XSS_EVENTS_INDIVIDUAL = [
    r"(?i)\bonabort\s*=",
    r"(?i)\bonafterprint\s*=",
    r"(?i)\bonanimationend\s*=",
    r"(?i)\bonanimationiteration\s*=",
    r"(?i)\bonanimationstart\s*=",
    r"(?i)\bonauxclick\s*=",
    r"(?i)\bonbeforecopy\s*=",
    r"(?i)\bonbeforecut\s*=",
    r"(?i)\bonbeforeinput\s*=",
    r"(?i)\bonbeforepaste\s*=",
    r"(?i)\bonbeforeprint\s*=",
    r"(?i)\bonbeforeunload\s*=",
    r"(?i)\bonblur\s*=",
    r"(?i)\boncanplay\s*=",
    r"(?i)\boncanplaythrough\s*=",
    r"(?i)\bonchange\s*=",
    r"(?i)\bonclick\s*=",
    r"(?i)\bonclose\s*=",
    r"(?i)\boncontextmenu\s*=",
    r"(?i)\boncopy\s*=",
    r"(?i)\boncuechange\s*=",
    r"(?i)\boncut\s*=",
    r"(?i)\bondblclick\s*=",
    r"(?i)\bondevicemotion\s*=",
    r"(?i)\bondeviceorientation\s*=",
    r"(?i)\bondrag\s*=",
    r"(?i)\bondragend\s*=",
    r"(?i)\bondragenter\s*=",
    r"(?i)\bondragexit\s*=",
    r"(?i)\bondragleave\s*=",
    r"(?i)\bondragover\s*=",
    r"(?i)\bondragstart\s*=",
    r"(?i)\bondrop\s*=",
    r"(?i)\bondurationchange\s*=",
    r"(?i)\bonemptied\s*=",
    r"(?i)\bonended\s*=",
    r"(?i)\bonerror\s*=",
    r"(?i)\bonfocus\s*=",
    r"(?i)\bonfocusin\s*=",
    r"(?i)\bonfocusout\s*=",
    r"(?i)\bonformdata\s*=",
    r"(?i)\bonfullscreenchange\s*=",
    r"(?i)\bonfullscreenerror\s*=",
    r"(?i)\bongotpointercapture\s*=",
    r"(?i)\bonhashchange\s*=",
    r"(?i)\boninput\s*=",
    r"(?i)\boninvalid\s*=",
    r"(?i)\bonkeydown\s*=",
    r"(?i)\bonkeypress\s*=",
    r"(?i)\bonkeyup\s*=",
    r"(?i)\bonlanguagechange\s*=",
    r"(?i)\bonload\s*=",
    r"(?i)\bonloadeddata\s*=",
    r"(?i)\bonloadedmetadata\s*=",
    r"(?i)\bonloadend\s*=",
    r"(?i)\bonloadstart\s*=",
    r"(?i)\bonlostpointercapture\s*=",
    r"(?i)\bonmessage\s*=",
    r"(?i)\bonmessageerror\s*=",
    r"(?i)\bonmousedown\s*=",
    r"(?i)\bonmouseenter\s*=",
    r"(?i)\bonmouseleave\s*=",
    r"(?i)\bonmousemove\s*=",
    r"(?i)\bonmouseout\s*=",
    r"(?i)\bonmouseover\s*=",
    r"(?i)\bonmouseup\s*=",
    r"(?i)\bonmousewheel\s*=",
    r"(?i)\bonoffline\s*=",
    r"(?i)\bononline\s*=",
    r"(?i)\bonopen\s*=",
    r"(?i)\bonorientationchange\s*=",
    r"(?i)\bonpagehide\s*=",
    r"(?i)\bonpageshow\s*=",
    r"(?i)\bonpaste\s*=",
    r"(?i)\bonpause\s*=",
    r"(?i)\bonplay\s*=",
    r"(?i)\bonplaying\s*=",
    r"(?i)\bonpointercancel\s*=",
    r"(?i)\bonpointerdown\s*=",
    r"(?i)\bonpointerenter\s*=",
    r"(?i)\bonpointerleave\s*=",
    r"(?i)\bonpointermove\s*=",
    r"(?i)\bonpointerout\s*=",
    r"(?i)\bonpointerover\s*=",
    r"(?i)\bonpointerrawupdate\s*=",
    r"(?i)\bonpointerup\s*=",
    r"(?i)\bonpopstate\s*=",
    r"(?i)\bonprogress\s*=",
    r"(?i)\bonratechange\s*=",
    r"(?i)\bonreadystatechange\s*=",
    r"(?i)\bonrejectionhandled\s*=",
    r"(?i)\bonreset\s*=",
    r"(?i)\bonresize\s*=",
    r"(?i)\bonscroll\s*=",
    r"(?i)\bonscrollend\s*=",
    r"(?i)\bonsearch\s*=",
    r"(?i)\bonsecuritypolicyviolation\s*=",
    r"(?i)\bonseeked\s*=",
    r"(?i)\bonseeking\s*=",
    r"(?i)\bonselect\s*=",
    r"(?i)\bonselectionchange\s*=",
    r"(?i)\bonselectstart\s*=",
    r"(?i)\bonslotchange\s*=",
    r"(?i)\bonstalled\s*=",
    r"(?i)\bonstorage\s*=",
    r"(?i)\bonsubmit\s*=",
    r"(?i)\bonsuspend\s*=",
    r"(?i)\bontimeupdate\s*=",
    r"(?i)\bontoggle\s*=",
    r"(?i)\bontouchcancel\s*=",
    r"(?i)\bontouchend\s*=",
    r"(?i)\bontouchforcechange\s*=",
    r"(?i)\bontouchmove\s*=",
    r"(?i)\bontouchstart\s*=",
    r"(?i)\bontransitioncancel\s*=",
    r"(?i)\bontransitionend\s*=",
    r"(?i)\bontransitionrun\s*=",
    r"(?i)\bontransitionstart\s*=",
    r"(?i)\bonunhandledrejection\s*=",
    r"(?i)\bonunload\s*=",
    r"(?i)\bonvisibilitychange\s*=",
    r"(?i)\bonvolumechange\s*=",
    r"(?i)\bonwaiting\s*=",
    r"(?i)\bonwebkitanimationend\s*=",
    r"(?i)\bonwebkitanimationiteration\s*=",
    r"(?i)\bonwebkitanimationstart\s*=",
    r"(?i)\bonwebkittransitionend\s*=",
    r"(?i)\bonwheel\s*=",
    # --- JS function calls in XSS context ---
    r"(?i)alert\s*\(\s*['\"]?\w",
    r"(?i)alert\s*\(\s*document\.",
    r"(?i)alert\s*\(\s*window\.",
    r"(?i)alert\s*\(\s*location\.",
    r"(?i)alert\s*\(\s*\d+\s*\)",
    r"(?i)alert\s*\(\s*String\.fromCharCode",
    r"(?i)confirm\s*\(\s*['\"]",
    r"(?i)confirm\s*\(\s*document\.",
    r"(?i)prompt\s*\(\s*['\"]",
    r"(?i)prompt\s*\(\s*document\.",
    r"(?i)eval\s*\(\s*['\"]",
    r"(?i)eval\s*\(\s*atob\(",
    r"(?i)eval\s*\(\s*unescape\(",
    r"(?i)eval\s*\(\s*decodeURI",
    r"(?i)eval\s*\(\s*String\.fromCharCode",
    r"(?i)eval\s*\(\s*document\.",
    r"(?i)eval\s*\(\s*window\.",
    r"(?i)eval\s*\(\s*location\.",
    r"(?i)Function\s*\(\s*['\"]",
    r"(?i)Function\s*\(\s*atob\(",
    r"(?i)Function\s*\(\s*unescape\(",
    r"(?i)Function\s*\(\s*String\.fromCharCode",
    r"(?i)setTimeout\s*\(\s*['\"]",
    r"(?i)setTimeout\s*\(\s*atob\(",
    r"(?i)setTimeout\s*\(\s*function",
    r"(?i)setInterval\s*\(\s*['\"]",
    r"(?i)setInterval\s*\(\s*function",
    r"(?i)setImmediate\s*\(\s*['\"]",
    r"(?i)execScript\s*\(\s*['\"]",
    r"(?i)document\.write\s*\(\s*['\"]?<",
    r"(?i)document\.write\s*\(\s*unescape",
    r"(?i)document\.write\s*\(\s*decodeURI",
    r"(?i)document\.write\s*\(\s*atob",
    r"(?i)document\.write\s*\(\s*String\.fromCharCode",
    r"(?i)document\.writeln\s*\(\s*['\"]?<",
    r"(?i)\.innerHTML\s*=\s*['\"]?<",
    r"(?i)\.innerHTML\s*=\s*unescape",
    r"(?i)\.innerHTML\s*=\s*decodeURI",
    r"(?i)\.innerHTML\s*=\s*atob",
    r"(?i)\.innerHTML\s*\+=\s*['\"]?<",
    r"(?i)\.outerHTML\s*=\s*['\"]?<",
    r"(?i)\.insertAdjacentHTML\s*\(\s*['\"]",
    r"(?i)document\.createElement\s*\(\s*['\"]script",
    r"(?i)document\.createElement\s*\(\s*['\"]img",
    r"(?i)document\.createElement\s*\(\s*['\"]iframe",
    r"(?i)document\.createElement\s*\(\s*['\"]object",
    r"(?i)document\.createElement\s*\(\s*['\"]embed",
    r"(?i)document\.createElement\s*\(\s*['\"]svg",
    r"(?i)\.setAttribute\s*\(\s*['\"]src['\"]",
    r"(?i)\.setAttribute\s*\(\s*['\"]href['\"]",
    r"(?i)\.setAttribute\s*\(\s*['\"]action['\"]",
    r"(?i)\.setAttribute\s*\(\s*['\"]data['\"]",
    r"(?i)\.setAttribute\s*\(\s*['\"]formaction['\"]",
    r"(?i)\.setAttribute\s*\(\s*['\"]poster['\"]",
    r"(?i)\.setAttribute\s*\(\s*['\"]background['\"]",
    r"(?i)\.setAttribute\s*\(\s*['\"]on\w+['\"]",
    r"(?i)\.src\s*=\s*['\"]?(?:javascript|data|vbscript):",
    r"(?i)\.href\s*=\s*['\"]?(?:javascript|data|vbscript):",
    r"(?i)\.action\s*=\s*['\"]?(?:javascript|data|vbscript):",
    r"(?i)document\.cookie\b",
    r"(?i)document\.domain\b",
    r"(?i)document\.location\b",
    r"(?i)document\.referrer\b",
    r"(?i)document\.URL\b",
    r"(?i)document\.documentURI\b",
    r"(?i)document\.baseURI\b",
    r"(?i)window\.location\b",
    r"(?i)window\.name\b",
    r"(?i)window\.opener\b",
    r"(?i)window\.parent\b",
    r"(?i)window\.top\b",
    r"(?i)window\.self\b",
    r"(?i)window\.frames\b",
    r"(?i)location\.href\b",
    r"(?i)location\.hash\b",
    r"(?i)location\.search\b",
    r"(?i)location\.pathname\b",
    r"(?i)location\.protocol\b",
    r"(?i)location\.hostname\b",
    r"(?i)location\.host\b",
    r"(?i)location\.origin\b",
    r"(?i)location\.assign\s*\(",
    r"(?i)location\.replace\s*\(",
    r"(?i)navigator\.userAgent\b",
    r"(?i)navigator\.appVersion\b",
    r"(?i)navigator\.platform\b",
    r"(?i)navigator\.plugins\b",
    r"(?i)navigator\.sendBeacon\s*\(",
    r"(?i)history\.pushState\s*\(",
    r"(?i)history\.replaceState\s*\(",
    r"(?i)localStorage\.getItem\s*\(",
    r"(?i)localStorage\.setItem\s*\(",
    r"(?i)sessionStorage\.getItem\s*\(",
    r"(?i)sessionStorage\.setItem\s*\(",
    r"(?i)XMLHttpRequest\s*\(\)",
    r"(?i)new\s+XMLHttpRequest\b",
    r"(?i)fetch\s*\(\s*['\"]",
    r"(?i)\.open\s*\(\s*['\"](?:GET|POST|PUT|DELETE|PATCH|HEAD|OPTIONS)",
    r"(?i)\.send\s*\(\s*(?:document|JSON|btoa|atob)",
    r"(?i)new\s+WebSocket\s*\(",
    r"(?i)new\s+EventSource\s*\(",
    r"(?i)new\s+Worker\s*\(",
    r"(?i)new\s+SharedWorker\s*\(",
    r"(?i)new\s+ServiceWorker\s*\(",
    r"(?i)new\s+BroadcastChannel\s*\(",
    r"(?i)postMessage\s*\(",
    r"(?i)importScripts\s*\(",
    r"(?i)Blob\s*\(\s*\[.*\]\s*,\s*\{\s*type\s*:\s*['\"](?:text/html|text/javascript|application/javascript)",
    r"(?i)URL\.createObjectURL\s*\(",
    r"(?i)atob\s*\(\s*['\"]",
    r"(?i)btoa\s*\(\s*['\"]",
    r"(?i)String\.fromCharCode\s*\(\s*\d+",
    r"(?i)String\.fromCodePoint\s*\(\s*\d+",
    r"(?i)unescape\s*\(\s*['\"]%",
    r"(?i)decodeURI\s*\(\s*['\"]%",
    r"(?i)decodeURIComponent\s*\(\s*['\"]%",
]

# ============================================================================
# 3. INDIVIDUAL SHELL COMMANDS (300 patterns)
# ============================================================================
SHELL_COMMANDS_INDIVIDUAL = [
    r"(?i);\s*id\b",
    r"(?i);\s*whoami\b",
    r"(?i);\s*uname\b",
    r"(?i);\s*hostname\b",
    r"(?i);\s*ifconfig\b",
    r"(?i);\s*ip\s+addr\b",
    r"(?i);\s*ip\s+route\b",
    r"(?i);\s*ip\s+link\b",
    r"(?i);\s*ip\s+neigh\b",
    r"(?i);\s*cat\s+/etc/passwd\b",
    r"(?i);\s*cat\s+/etc/shadow\b",
    r"(?i);\s*cat\s+/etc/hosts\b",
    r"(?i);\s*cat\s+/etc/hostname\b",
    r"(?i);\s*cat\s+/etc/resolv\.conf\b",
    r"(?i);\s*cat\s+/etc/sudoers\b",
    r"(?i);\s*cat\s+/etc/crontab\b",
    r"(?i);\s*cat\s+/etc/fstab\b",
    r"(?i);\s*cat\s+/etc/issue\b",
    r"(?i);\s*cat\s+/etc/motd\b",
    r"(?i);\s*cat\s+/etc/profile\b",
    r"(?i);\s*cat\s+/proc/version\b",
    r"(?i);\s*cat\s+/proc/cpuinfo\b",
    r"(?i);\s*cat\s+/proc/meminfo\b",
    r"(?i);\s*cat\s+/proc/self/environ\b",
    r"(?i);\s*cat\s+/proc/self/cmdline\b",
    r"(?i);\s*cat\s+/proc/self/status\b",
    r"(?i);\s*cat\s+/proc/self/maps\b",
    r"(?i);\s*cat\s+/proc/net/tcp\b",
    r"(?i);\s*cat\s+/proc/net/udp\b",
    r"(?i);\s*cat\s+/proc/net/arp\b",
    r"(?i);\s*ls\s+-la\b",
    r"(?i);\s*ls\s+-al\b",
    r"(?i);\s*ls\s+-lah\b",
    r"(?i);\s*ls\s+/\b",
    r"(?i);\s*ls\s+/etc\b",
    r"(?i);\s*ls\s+/home\b",
    r"(?i);\s*ls\s+/root\b",
    r"(?i);\s*ls\s+/tmp\b",
    r"(?i);\s*ls\s+/var\b",
    r"(?i);\s*dir\s+/\b",
    r"(?i);\s*pwd\b",
    r"(?i);\s*echo\s+\$",
    r"(?i);\s*printf\b",
    r"(?i);\s*env\b",
    r"(?i);\s*printenv\b",
    r"(?i);\s*set\b",
    r"(?i);\s*export\b",
    r"(?i);\s*alias\b",
    r"(?i);\s*history\b",
    r"(?i);\s*ps\s+aux\b",
    r"(?i);\s*ps\s+-ef\b",
    r"(?i);\s*ps\s+-eaf\b",
    r"(?i);\s*top\b",
    r"(?i);\s*htop\b",
    r"(?i);\s*kill\b",
    r"(?i);\s*pkill\b",
    r"(?i);\s*killall\b",
    r"(?i);\s*bg\b",
    r"(?i);\s*fg\b",
    r"(?i);\s*jobs\b",
    r"(?i);\s*nohup\b",
    r"(?i);\s*screen\b",
    r"(?i);\s*tmux\b",
    r"(?i);\s*crontab\b",
    r"(?i);\s*at\b",
    r"(?i);\s*systemctl\b",
    r"(?i);\s*service\b",
    r"(?i);\s*journalctl\b",
    r"(?i);\s*dmesg\b",
    r"(?i);\s*last\b",
    r"(?i);\s*lastlog\b",
    r"(?i);\s*who\b",
    r"(?i);\s*w\b",
    r"(?i);\s*finger\b",
    r"(?i);\s*users\b",
    r"(?i);\s*groups\b",
    r"(?i);\s*getent\b",
    r"(?i);\s*mount\b",
    r"(?i);\s*umount\b",
    r"(?i);\s*df\b",
    r"(?i);\s*du\b",
    r"(?i);\s*free\b",
    r"(?i);\s*vmstat\b",
    r"(?i);\s*iostat\b",
    r"(?i);\s*lsof\b",
    r"(?i);\s*fuser\b",
    r"(?i);\s*netstat\b",
    r"(?i);\s*ss\b",
    r"(?i);\s*iptables\b",
    r"(?i);\s*nftables\b",
    r"(?i);\s*ufw\b",
    r"(?i);\s*wget\s+http",
    r"(?i);\s*curl\s+http",
    r"(?i);\s*curl\s+-[a-zA-Z]*O",
    r"(?i);\s*curl\s+-[a-zA-Z]*d",
    r"(?i);\s*fetch\s+http",
    r"(?i);\s*nc\s+",
    r"(?i);\s*ncat\s+",
    r"(?i);\s*socat\s+",
    r"(?i);\s*ssh\s+",
    r"(?i);\s*scp\s+",
    r"(?i);\s*sftp\s+",
    r"(?i);\s*ftp\s+",
    r"(?i);\s*telnet\s+",
    r"(?i);\s*rsync\s+",
    r"(?i);\s*nmap\s+",
    r"(?i);\s*ping\s+",
    r"(?i);\s*traceroute\s+",
    r"(?i);\s*dig\s+",
    r"(?i);\s*nslookup\s+",
    r"(?i);\s*host\s+",
    r"(?i);\s*whois\s+",
    r"(?i);\s*python\s+-c\b",
    r"(?i);\s*python3\s+-c\b",
    r"(?i);\s*ruby\s+-e\b",
    r"(?i);\s*perl\s+-e\b",
    r"(?i);\s*php\s+-r\b",
    r"(?i);\s*node\s+-e\b",
    r"(?i);\s*lua\s+-e\b",
    r"(?i);\s*bash\s+-c\b",
    r"(?i);\s*sh\s+-c\b",
    r"(?i);\s*zsh\s+-c\b",
    r"(?i);\s*dash\s+-c\b",
    r"(?i);\s*ksh\s+-c\b",
    r"(?i);\s*csh\s+-c\b",
    r"(?i);\s*tcsh\s+-c\b",
    r"(?i);\s*chmod\s+[0-7]+\b",
    r"(?i);\s*chmod\s+[+]?[rwxsStTugo]+\b",
    r"(?i);\s*chown\s+",
    r"(?i);\s*chgrp\s+",
    r"(?i);\s*useradd\b",
    r"(?i);\s*userdel\b",
    r"(?i);\s*usermod\b",
    r"(?i);\s*groupadd\b",
    r"(?i);\s*groupdel\b",
    r"(?i);\s*groupmod\b",
    r"(?i);\s*passwd\b",
    r"(?i);\s*adduser\b",
    r"(?i);\s*deluser\b",
    r"(?i);\s*visudo\b",
    r"(?i);\s*su\s+",
    r"(?i);\s*sudo\s+",
    r"(?i);\s*find\s+/\s+",
    r"(?i);\s*find\s+.*-exec\b",
    r"(?i);\s*find\s+.*-perm\b",
    r"(?i);\s*find\s+.*-name\b",
    r"(?i);\s*find\s+.*-type\s+f\b",
    r"(?i);\s*find\s+.*-writable\b",
    r"(?i);\s*find\s+.*-readable\b",
    r"(?i);\s*find\s+.*-suid\b",
    r"(?i);\s*grep\s+-r\b",
    r"(?i);\s*grep\s+-rn\b",
    r"(?i);\s*grep\s+-ri\b",
    r"(?i);\s*egrep\b",
    r"(?i);\s*fgrep\b",
    r"(?i);\s*awk\b",
    r"(?i);\s*sed\b",
    r"(?i);\s*sort\b",
    r"(?i);\s*uniq\b",
    r"(?i);\s*wc\b",
    r"(?i);\s*head\b",
    r"(?i);\s*tail\b",
    r"(?i);\s*cut\b",
    r"(?i);\s*tr\b",
    r"(?i);\s*tee\b",
    r"(?i);\s*xargs\b",
    r"(?i);\s*tar\b",
    r"(?i);\s*zip\b",
    r"(?i);\s*unzip\b",
    r"(?i);\s*gzip\b",
    r"(?i);\s*gunzip\b",
    r"(?i);\s*bzip2\b",
    r"(?i);\s*bunzip2\b",
    r"(?i);\s*xz\b",
    r"(?i);\s*7z\b",
    r"(?i);\s*rar\b",
    r"(?i);\s*unrar\b",
    r"(?i);\s*dd\s+if=",
    r"(?i);\s*cp\s+/",
    r"(?i);\s*mv\s+/",
    r"(?i);\s*rm\s+-rf\b",
    r"(?i);\s*rm\s+-f\b",
    r"(?i);\s*rmdir\b",
    r"(?i);\s*mkdir\b",
    r"(?i);\s*touch\b",
    r"(?i);\s*ln\s+-s\b",
    r"(?i);\s*mkfifo\b",
    r"(?i);\s*mknod\b",
    r"(?i);\s*base64\b",
    r"(?i);\s*xxd\b",
    r"(?i);\s*od\b",
    r"(?i);\s*hexdump\b",
    r"(?i);\s*strings\b",
    r"(?i);\s*file\b",
    r"(?i);\s*stat\b",
    r"(?i);\s*strace\b",
    r"(?i);\s*ltrace\b",
    r"(?i);\s*gdb\b",
    r"(?i);\s*objdump\b",
    r"(?i);\s*readelf\b",
    r"(?i);\s*nm\b",
    r"(?i);\s*ldd\b",
    r"(?i);\s*apt\b",
    r"(?i);\s*apt-get\b",
    r"(?i);\s*dpkg\b",
    r"(?i);\s*yum\b",
    r"(?i);\s*dnf\b",
    r"(?i);\s*rpm\b",
    r"(?i);\s*pacman\b",
    r"(?i);\s*snap\b",
    r"(?i);\s*flatpak\b",
    r"(?i);\s*pip\s+install\b",
    r"(?i);\s*pip3\s+install\b",
    r"(?i);\s*npm\s+install\b",
    r"(?i);\s*gem\s+install\b",
    r"(?i);\s*composer\s+install\b",
    r"(?i);\s*go\s+install\b",
    r"(?i);\s*cargo\s+install\b",
    r"(?i);\s*docker\s+exec\b",
    r"(?i);\s*docker\s+run\b",
    r"(?i);\s*kubectl\s+exec\b",
    r"(?i);\s*kubectl\s+get\b",
    r"(?i);\s*terraform\s+apply\b",
    r"(?i);\s*ansible\b",
    r"(?i);\s*git\s+clone\b",
    r"(?i);\s*svn\s+checkout\b",
    r"(?i);\s*hg\s+clone\b",
    # --- Pipe-based commands ---
    r"(?i)\|\s*sh\b",
    r"(?i)\|\s*bash\b",
    r"(?i)\|\s*zsh\b",
    r"(?i)\|\s*dash\b",
    r"(?i)\|\s*python\b",
    r"(?i)\|\s*python3\b",
    r"(?i)\|\s*ruby\b",
    r"(?i)\|\s*perl\b",
    r"(?i)\|\s*php\b",
    r"(?i)\|\s*node\b",
    r"(?i)\|\s*nc\b",
    r"(?i)\|\s*ncat\b",
    r"(?i)\|\s*tee\b",
    r"(?i)\|\s*base64\b",
    r"(?i)\|\s*xxd\b",
    r"(?i)\|\s*mail\b",
    r"(?i)\|\s*sendmail\b",
    r"(?i)\|\s*curl\b",
    r"(?i)\|\s*wget\b",
    # --- Double ampersand commands ---
    r"(?i)&&\s*id\b",
    r"(?i)&&\s*whoami\b",
    r"(?i)&&\s*cat\s+/etc/",
    r"(?i)&&\s*ls\s+-la\b",
    r"(?i)&&\s*wget\b",
    r"(?i)&&\s*curl\b",
    r"(?i)&&\s*nc\b",
    r"(?i)&&\s*python\b",
    r"(?i)&&\s*bash\b",
    r"(?i)&&\s*sh\b",
    r"(?i)&&\s*chmod\b",
    r"(?i)&&\s*rm\s+-rf\b",
]

# ============================================================================
# 4. SENSITIVE FILE PATHS (200 patterns)
# ============================================================================
SENSITIVE_PATHS_INDIVIDUAL = [
    r"(?i)/etc/passwd\b",
    r"(?i)/etc/shadow\b",
    r"(?i)/etc/group\b",
    r"(?i)/etc/gshadow\b",
    r"(?i)/etc/hosts\b",
    r"(?i)/etc/hostname\b",
    r"(?i)/etc/resolv\.conf\b",
    r"(?i)/etc/fstab\b",
    r"(?i)/etc/mtab\b",
    r"(?i)/etc/issue\b",
    r"(?i)/etc/motd\b",
    r"(?i)/etc/profile\b",
    r"(?i)/etc/bashrc\b",
    r"(?i)/etc/environment\b",
    r"(?i)/etc/shells\b",
    r"(?i)/etc/sudoers\b",
    r"(?i)/etc/crontab\b",
    r"(?i)/etc/securetty\b",
    r"(?i)/etc/ssh/sshd_config\b",
    r"(?i)/etc/ssh/ssh_config\b",
    r"(?i)/etc/ssh/ssh_host_rsa_key\b",
    r"(?i)/etc/ssh/ssh_host_dsa_key\b",
    r"(?i)/etc/ssh/ssh_host_ecdsa_key\b",
    r"(?i)/etc/ssh/ssh_host_ed25519_key\b",
    r"(?i)/etc/apache2/apache2\.conf\b",
    r"(?i)/etc/apache2/httpd\.conf\b",
    r"(?i)/etc/apache2/sites-enabled\b",
    r"(?i)/etc/apache2/sites-available\b",
    r"(?i)/etc/httpd/conf/httpd\.conf\b",
    r"(?i)/etc/nginx/nginx\.conf\b",
    r"(?i)/etc/nginx/sites-enabled\b",
    r"(?i)/etc/nginx/sites-available\b",
    r"(?i)/etc/nginx/conf\.d\b",
    r"(?i)/etc/mysql/my\.cnf\b",
    r"(?i)/etc/mysql/mysql\.conf\.d\b",
    r"(?i)/etc/my\.cnf\b",
    r"(?i)/etc/postgresql/\d+/main/pg_hba\.conf\b",
    r"(?i)/etc/postgresql/\d+/main/postgresql\.conf\b",
    r"(?i)/etc/redis/redis\.conf\b",
    r"(?i)/etc/redis\.conf\b",
    r"(?i)/etc/mongod\.conf\b",
    r"(?i)/etc/elasticsearch/elasticsearch\.yml\b",
    r"(?i)/etc/kibana/kibana\.yml\b",
    r"(?i)/etc/logstash/logstash\.yml\b",
    r"(?i)/etc/postfix/main\.cf\b",
    r"(?i)/etc/dovecot/dovecot\.conf\b",
    r"(?i)/etc/bind/named\.conf\b",
    r"(?i)/etc/openvpn/server\.conf\b",
    r"(?i)/etc/ipsec\.conf\b",
    r"(?i)/etc/pam\.d/\w+\b",
    r"(?i)/etc/security/limits\.conf\b",
    r"(?i)/etc/security/access\.conf\b",
    r"(?i)/etc/nsswitch\.conf\b",
    r"(?i)/etc/syslog\.conf\b",
    r"(?i)/etc/rsyslog\.conf\b",
    r"(?i)/etc/logrotate\.conf\b",
    r"(?i)/etc/ld\.so\.conf\b",
    r"(?i)/etc/ld\.so\.preload\b",
    r"(?i)/etc/sysctl\.conf\b",
    r"(?i)/etc/rc\.local\b",
    r"(?i)/proc/version\b",
    r"(?i)/proc/cpuinfo\b",
    r"(?i)/proc/meminfo\b",
    r"(?i)/proc/partitions\b",
    r"(?i)/proc/diskstats\b",
    r"(?i)/proc/vmstat\b",
    r"(?i)/proc/loadavg\b",
    r"(?i)/proc/uptime\b",
    r"(?i)/proc/modules\b",
    r"(?i)/proc/interrupts\b",
    r"(?i)/proc/ioports\b",
    r"(?i)/proc/iomem\b",
    r"(?i)/proc/devices\b",
    r"(?i)/proc/filesystems\b",
    r"(?i)/proc/swaps\b",
    r"(?i)/proc/cmdline\b",
    r"(?i)/proc/config\.gz\b",
    r"(?i)/proc/net/tcp\b",
    r"(?i)/proc/net/udp\b",
    r"(?i)/proc/net/arp\b",
    r"(?i)/proc/net/route\b",
    r"(?i)/proc/net/fib_trie\b",
    r"(?i)/proc/self/environ\b",
    r"(?i)/proc/self/cmdline\b",
    r"(?i)/proc/self/status\b",
    r"(?i)/proc/self/maps\b",
    r"(?i)/proc/self/mem\b",
    r"(?i)/proc/self/fd/\d+\b",
    r"(?i)/proc/self/cwd\b",
    r"(?i)/proc/self/exe\b",
    r"(?i)/proc/self/root\b",
    r"(?i)/proc/self/mountinfo\b",
    r"(?i)/proc/self/mounts\b",
    r"(?i)/proc/self/cgroup\b",
    r"(?i)/proc/self/loginuid\b",
    r"(?i)/proc/self/io\b",
    r"(?i)/proc/self/stat\b",
    r"(?i)/proc/self/statm\b",
    r"(?i)/proc/self/stack\b",
    r"(?i)/var/log/auth\.log\b",
    r"(?i)/var/log/syslog\b",
    r"(?i)/var/log/messages\b",
    r"(?i)/var/log/secure\b",
    r"(?i)/var/log/faillog\b",
    r"(?i)/var/log/lastlog\b",
    r"(?i)/var/log/btmp\b",
    r"(?i)/var/log/wtmp\b",
    r"(?i)/var/log/utmp\b",
    r"(?i)/var/log/kern\.log\b",
    r"(?i)/var/log/dmesg\b",
    r"(?i)/var/log/daemon\.log\b",
    r"(?i)/var/log/debug\b",
    r"(?i)/var/log/boot\.log\b",
    r"(?i)/var/log/dpkg\.log\b",
    r"(?i)/var/log/apache2/access\.log\b",
    r"(?i)/var/log/apache2/error\.log\b",
    r"(?i)/var/log/nginx/access\.log\b",
    r"(?i)/var/log/nginx/error\.log\b",
    r"(?i)/var/log/mysql/error\.log\b",
    r"(?i)/var/log/postgresql/\w+\.log\b",
    r"(?i)/var/log/redis/redis-server\.log\b",
    r"(?i)/var/log/mongodb/mongod\.log\b",
    r"(?i)/root/\.bash_history\b",
    r"(?i)/root/\.bashrc\b",
    r"(?i)/root/\.profile\b",
    r"(?i)/root/\.ssh/id_rsa\b",
    r"(?i)/root/\.ssh/id_dsa\b",
    r"(?i)/root/\.ssh/id_ecdsa\b",
    r"(?i)/root/\.ssh/id_ed25519\b",
    r"(?i)/root/\.ssh/authorized_keys\b",
    r"(?i)/root/\.ssh/known_hosts\b",
    r"(?i)/root/\.ssh/config\b",
    r"(?i)/root/\.mysql_history\b",
    r"(?i)/root/\.psql_history\b",
    r"(?i)/root/\.aws/credentials\b",
    r"(?i)/root/\.aws/config\b",
    r"(?i)/root/\.kube/config\b",
    r"(?i)/root/\.docker/config\.json\b",
    r"(?i)/root/\.gnupg/\b",
    r"(?i)/home/\w+/\.bash_history\b",
    r"(?i)/home/\w+/\.bashrc\b",
    r"(?i)/home/\w+/\.profile\b",
    r"(?i)/home/\w+/\.ssh/id_rsa\b",
    r"(?i)/home/\w+/\.ssh/authorized_keys\b",
    r"(?i)/home/\w+/\.ssh/config\b",
    r"(?i)/home/\w+/\.mysql_history\b",
    r"(?i)/home/\w+/\.aws/credentials\b",
    r"(?i)/home/\w+/\.kube/config\b",
    r"(?i)C:\\Windows\\system\.ini\b",
    r"(?i)C:\\Windows\\win\.ini\b",
    r"(?i)C:\\boot\.ini\b",
    r"(?i)C:\\Windows\\System32\\drivers\\etc\\hosts\b",
    r"(?i)C:\\Windows\\System32\\config\\SAM\b",
    r"(?i)C:\\Windows\\System32\\config\\SYSTEM\b",
    r"(?i)C:\\Windows\\System32\\config\\SOFTWARE\b",
    r"(?i)C:\\Windows\\System32\\config\\SECURITY\b",
    r"(?i)C:\\Windows\\repair\\SAM\b",
    r"(?i)C:\\Windows\\repair\\system\b",
    r"(?i)C:\\inetpub\\wwwroot\\web\.config\b",
    r"(?i)C:\\Windows\\Panther\\Unattend\.xml\b",
    r"(?i)C:\\Windows\\debug\\NetSetup\.log\b",
    r"(?i)C:\\Windows\\Temp\\\b",
    r"(?i)\.htaccess\b",
    r"(?i)\.htpasswd\b",
    r"(?i)\.htdigest\b",
    r"(?i)\.env\b",
    r"(?i)\.env\.local\b",
    r"(?i)\.env\.production\b",
    r"(?i)\.env\.development\b",
    r"(?i)\.env\.staging\b",
    r"(?i)\.env\.test\b",
    r"(?i)wp-config\.php\b",
    r"(?i)configuration\.php\b",
    r"(?i)config\.inc\.php\b",
    r"(?i)LocalSettings\.php\b",
    r"(?i)settings\.py\b",
    r"(?i)database\.yml\b",
    r"(?i)secrets\.yml\b",
    r"(?i)credentials\.yml\.enc\b",
    r"(?i)master\.key\b",
    r"(?i)\.git/config\b",
    r"(?i)\.git/HEAD\b",
    r"(?i)\.git/index\b",
    r"(?i)\.svn/entries\b",
    r"(?i)\.svn/wc\.db\b",
    r"(?i)\.hg/dirstate\b",
    r"(?i)\.DS_Store\b",
    r"(?i)Thumbs\.db\b",
    r"(?i)desktop\.ini\b",
    r"(?i)\.idea/workspace\.xml\b",
    r"(?i)\.vscode/settings\.json\b",
]

# ============================================================================
# 5. SCANNER / TOOL FINGERPRINTS (200 patterns)
# ============================================================================
SCANNER_FINGERPRINTS = [
    r"(?i)(?:sqlmap|havij|pangolin|absinthe|safe3|jsql|bbqsql|blisqy|whitewidow|mole|tyrant|dbltek|hexjector|sqldumper|darkMySQLi|DSSS|nosqlmap|mongoaudit|Ghauri)\b",
    r"(?i)(?:nmap|masscan|zmap|rustscan|unicornscan|angryip|fping|hping3|arping|netdiscover|arp-scan|bettercap|ettercap|dsniff|arpspoof|macchanger|mitmproxy|mitmf|responder|impacket)\b",
    r"(?i)(?:nikto|wapiti|arachni|skipfish|w3af|vega|zap|owasp-zap|burp|burpsuite|acunetix|nessus|qualys|rapid7|nexpose|openvas|netsparker|invicti|detectify|probely|intruder|portswigger|appspider|webinspect|fortify|veracode|checkmarx|snyk|sonarqube|semgrep|codeql|bandit|brakeman|gosec|safety|trivy|grype|syft|anchore|twistlock|prisma|aqua|falco|sysdig|calico|cilium|istio|linkerd)\b",
    r"(?i)(?:dirsearch|dirb|dirbuster|gobuster|ffuf|wfuzz|feroxbuster|rustbuster|tachyon|cmsmap|droopescan|joomscan|wpscan|wpvulndb|vulnx|whatweb|wafw00f|identywaf|ninjafirewall|cloudflair|subfinder|amass|assetfinder|sublist3r|fierce|dnsrecon|dnsenum|dnsmap|dnstracer|dnswalk|knock|subbrute|altdns|massdns|shuffledns|puredns|gotator|regulator|cero|hakrawler|gospider|katana|gau|waybackurls|httpx|httprobe|httpie|axiom)\b",
    r"(?i)(?:metasploit|msfconsole|msfvenom|meterpreter|armitage|cobalt-strike|covenant|empire|pupy|koadic|silenttrinity|mythic|sliver|havoc|brute-ratel|villain|poshc2|merlin|faction|apfell|deimos|nuages|kubesploit|cloudfox|pacu|prowler|scoutsuite|steampipe|cloudquery|cartography|cloudsplaining|pmapper|iamlive|enumerate-iam|awspx|weirdaal|cloudgoat|thunder)\b",
    r"(?i)(?:hydra|medusa|ncrack|crowbar|thc-hydra|brutex|patator|wfuzz|credmaster|spraying-toolkit|trevorspray|o365spray|msolspray|ruler|mailsniper|exchange-server-attacktools|privexchange|proxylogon|proxyshell|proxynotshell)\b",
    r"(?i)(?:john\s+(?:the\s+ripper|--|--wordlist|--format|--rules)|hashcat|ophcrack|rainbowcrack|l0phtcrack|cain-abel|aircrack-ng|cowpatty|pyrit|wifite|fern-wifi-cracker|fluxion|wifiphisher|eaphammer|hostapd-mana|mdk3|mdk4|bully|reaver|pixiewps|wash|hcxdumptool|hcxpcaptool|hcxtools)\b",
    r"(?i)(?:mimikatz|lazagne|pypykatz|impacket-secretsdump|procdump|sqldumper|comsvcs|ntdsutil|vssadmin|wce|gsecdump|fgdump|pwdumpx|cachedump|lsadump|samcats|hashdump|meterpreter|incognito|golden-ticket|silver-ticket|kerberoast|asreproast|rubeus|sharphound|bloodhound|plumhound|goodhound|adalanche|pingcastle|grouper2|group3r|privesc|winpeas|linpeas|linenum|linux-exploit-suggester|windows-exploit-suggester|sherlock|watson|seatbelt|sharpup|powerup|beroot|gtfobins|lolbas|living-off-the-land)\b",
    r"(?i)\b(?:burpcollaborator|oastify|interact\.sh|dnslog|ceye|eyes\.sh|canarytokens|requestbin|webhook\.site|pipedream|hookbin|beeceptor|postb\.in|ptsv2|ngrok|localtunnel|serveo|telebit|bore|cloudflared|frp|chisel|ligolo|revsocks|rpivot|shuttle|sshuttle|proxychains|tsocks|redsocks|torsocks|tor|i2p|freenet)\b",
    r"(?i)(?:commix|tplmap|sstimap|SSTImap|nosqlmap|CRLFuzz|crlfinjection|xxeinjector|XXEinjector|oxml_xxe|DTD-Finder|xsstrike|XSStrike|dalfox|Dalfox|kxss|XSpear|xsser|xsscrapy|polyglot|findom-xss|domdig|XSSHunter|knoxss)\b",
    r"(?i)User-Agent:\s*(?:.*(?:bot|spider|crawler|scraper|scan|check|monitor|probe|test|audit|assess|pentest|hack|exploit|attack|vuln|security|recon|enum|brute|fuzz|inject|payload|malware|virus|trojan|worm|ransomware|backdoor|rootkit|keylogger|spyware|adware|phishing|spam|dos|ddos|flood|amplif|reflect|synack))",
    r"(?i)User-Agent:\s*(?:python-requests|python-urllib|java/|libwww-perl|lwp-|wget|curl|httpie|postman|insomnia|paw|rest-client|restsharp|axios|got|node-fetch|superagent|request|http\.client|aiohttp|scrapy|beautifulsoup|selenium|puppeteer|playwright|phantomjs|headless|chrome-lighthouse|googlebot|bingbot|yandexbot|baidubot|duckduckbot|applebot|mj12bot|semrushbot|ahrefsbot|dotbot|rogerbot|blexbot|petalbot|screaming\s*frog|sitebulb|deepcrawl|oncrawl|botify|contentking|little-forest|netcraft|censys|shodan|zoomeye|fofa|quake|hunter|fullhunt|greynoise|securitytrails|virustotal|urlscan|hybrid-analysis|any\.run|joe-sandbox|triage|malshare|bazaar|threatfox|feodotracker|sslbl|urlhaus|phishtank|openphish|spamhaus|surbl|uribl|barracuda|proofpoint|mimecast|fireeye|crowdstrike|sentinelone|cybereason|tanium|carbon-black|cortex-xdr|elastic-agent|wazuh|ossec|suricata|snort|bro|zeek|moloch|arkime|rita|beehive|thehive|misp|opencti|yeti|maltego|spiderfoot|recon-ng|theHarvester|osrframework|datasploit|email2phonenumber|infoga|pwndb|h8mail|scylla|dehashed|snusbase|leakcheck|breachdirectory|haveibeenpwned|intelx|grep\.app)\b",
    # --- Specific scanner headers ---
    r"(?i)X-Scanner:\s*\w+",
    r"(?i)X-Scan-Memo:\s*\w+",
    r"(?i)X-Wappalyzer:\s*\w+",
    r"(?i)X-Originating-IP:\s*\d+\.\d+\.\d+\.\d+",
    r"(?i)X-Forwarded-For:\s*(?:\d+\.\d+\.\d+\.\d+\s*,?\s*){3,}",
    r"(?i)X-Client-IP:\s*\d+\.\d+\.\d+\.\d+",
    r"(?i)X-Remote-IP:\s*\d+\.\d+\.\d+\.\d+",
    r"(?i)X-Remote-Addr:\s*\d+\.\d+\.\d+\.\d+",
    r"(?i)Proxy-Connection:\s*keep-alive\b",
    # --- Scanner behavior patterns ---
    r"(?i)/\w+(?:\.(?:bak|backup|old|orig|original|copy|save|tmp|temp|swp|swo|swn|vim|~|dist|sample|example|test|dev|debug|staging|prod|production|log|sql|db|dump|tar|gz|zip|rar|7z|tgz|bz2|xz|cab|iso|img|bin|exe|dll|so|dylib|lib|obj|class|jar|war|ear|deb|rpm|pkg|msi|dmg|app|apk|ipa|aab|whl|egg|gem|nupkg))\b",
    r"(?i)/(?:phpinfo|info|test|debug|trace|status|health|ping|version|about|readme|changelog|license|todo|fixme|hack|xxx|temp|tmp|backup|bak|old|copy|admin|login|register|signup|reset|forgot|recover|verify|confirm|activate|deactivate|enable|disable|install|setup|config|configure|init|initialize|migrate|seed|update|upgrade|patch|fix|repair|rebuild|refresh|reload|restart|shutdown|kill|stop|start|pause|resume|maintenance|demo|sample|example|prototype|poc|lab|experiment|sandbox|playground|test|qa|uat|staging|dev|development|local|internal|private|secret|hidden|restricted|protected|secure|encrypted|confidential|sensitive|critical|important|urgent|priority|emergency|alert|warning|notice|info|debug|trace|verbose|log|audit|monitor|profile|benchmark|performance|metrics|stats|analytics|telemetry|observability|diagnostic|troubleshoot)\.(php|asp|aspx|jsp|do|action|cgi|pl|py|rb|cfm|shtml|xhtml|html|htm|txt|xml|json|yaml|yml|ini|conf|cfg|cnf|env|properties|toml|hcl|tf|tfvars|tfstate|lock|pid|sock|log|sql|db|sqlite|csv|tsv|xls|xlsx|doc|docx|pdf|ppt|pptx|md|rst|tex|rtf|odt|ods|odp|bak|backup|old|orig|tmp|temp|swp|dist|sample|example)\b",
]

# ============================================================================
# 6. TEMPLATE INJECTION / SSTI DEEP (150 patterns)
# ============================================================================
SSTI_DEEP = [
    r"(?i)\{\{\s*7\s*\*\s*7\s*\}\}",
    r"(?i)\{\{\s*7\s*\*\s*'7'\s*\}\}",
    r"(?i)\$\{\s*7\s*\*\s*7\s*\}",
    r"(?i)#\{\s*7\s*\*\s*7\s*\}",
    r"(?i)<%=\s*7\s*\*\s*7\s*%>",
    r"(?i)\{\{\s*config\s*\}\}",
    r"(?i)\{\{\s*config\.items\s*\(\)\s*\}\}",
    r"(?i)\{\{\s*self\._TemplateReference__context\s*\}\}",
    r"(?i)\{\{\s*request\.environ\s*\}\}",
    r"(?i)\{\{\s*request\.application\s*\}\}",
    r"(?i)\{\{.*__class__.*\}\}",
    r"(?i)\{\{.*__mro__.*\}\}",
    r"(?i)\{\{.*__subclasses__.*\}\}",
    r"(?i)\{\{.*__globals__.*\}\}",
    r"(?i)\{\{.*__builtins__.*\}\}",
    r"(?i)\{\{.*__import__.*\}\}",
    r"(?i)\{\{.*__init__.*\}\}",
    r"(?i)\{\{.*__dict__.*\}\}",
    r"(?i)\{\{.*__doc__.*\}\}",
    r"(?i)\{\{.*__module__.*\}\}",
    r"(?i)\{\{.*__name__.*\}\}",
    r"(?i)\{\{.*__qualname__.*\}\}",
    r"(?i)\{\{.*__bases__.*\}\}",
    r"(?i)\{\{.*__code__.*\}\}",
    r"(?i)\{\{.*__func__.*\}\}",
    r"(?i)\{\{.*__self__.*\}\}",
    r"(?i)\{\{.*__wrapped__.*\}\}",
    r"(?i)\{\{.*popen.*\}\}",
    r"(?i)\{\{.*Popen.*\}\}",
    r"(?i)\{\{.*subprocess.*\}\}",
    r"(?i)\{\{.*os\.system.*\}\}",
    r"(?i)\{\{.*os\.popen.*\}\}",
    r"(?i)\{\{.*os\.exec.*\}\}",
    r"(?i)\{\{.*eval\(.*\}\}",
    r"(?i)\{\{.*exec\(.*\}\}",
    r"(?i)\{\{.*compile\(.*\}\}",
    r"(?i)\{\{.*open\(.*\}\}",
    r"(?i)\{\{.*input\(.*\}\}",
    r"(?i)\{\{.*breakpoint\(.*\}\}",
    r"(?i)\{\{.*getattr.*\}\}",
    r"(?i)\{\{.*setattr.*\}\}",
    r"(?i)\{\{.*delattr.*\}\}",
    r"(?i)\{\{.*hasattr.*\}\}",
    r"(?i)\{\{.*globals\(.*\}\}",
    r"(?i)\{\{.*locals\(.*\}\}",
    r"(?i)\{\{.*vars\(.*\}\}",
    r"(?i)\{\{.*dir\(.*\}\}",
    r"(?i)\{\{.*type\(.*\}\}",
    r"(?i)\{\{.*id\(.*\}\}",
    r"(?i)\{\{.*chr\(.*\}\}",
    r"(?i)\{\{.*ord\(.*\}\}",
    r"(?i)\{\{.*hex\(.*\}\}",
    r"(?i)\{\{.*oct\(.*\}\}",
    r"(?i)\{\{.*bin\(.*\}\}",
    r"(?i)\{\{.*format\(.*\}\}",
    r"(?i)\{\{.*repr\(.*\}\}",
    r"(?i)\{\{.*ascii\(.*\}\}",
    r"(?i)\{\{.*lipsum.*\}\}",
    r"(?i)\{\{.*cycler.*\}\}",
    r"(?i)\{\{.*joiner.*\}\}",
    r"(?i)\{\{.*namespace.*\}\}",
    r"(?i)\{\{.*range\(.*\}\}",
    r"(?i)\{\{.*dict\(.*\}\}",
    r"(?i)\$\{.*Runtime.*\}",
    r"(?i)\$\{.*ProcessBuilder.*\}",
    r"(?i)\$\{.*Class\.forName.*\}",
    r"(?i)\$\{.*Thread\.sleep.*\}",
    r"(?i)\$\{.*System\.exit.*\}",
    r"(?i)\$\{.*System\.getProperty.*\}",
    r"(?i)\$\{.*System\.getenv.*\}",
    r"(?i)#\{.*Runtime.*\}",
    r"(?i)#\{.*ProcessBuilder.*\}",
    r"(?i)#\{.*Class\.forName.*\}",
    r"(?i)<%.*Runtime.*%>",
    r"(?i)<%.*ProcessBuilder.*%>",
    r"(?i)<%.*exec\(.*%>",
    r"(?i)<%.*system\(.*%>",
    r"(?i)<%.*eval\(.*%>",
    r"(?i)\{#.*import\s+os.*#\}",
    r"(?i)\{%.*import\s+os.*%\}",
    r"(?i)\{%.*set\s+.*=.*popen.*%\}",
    r"(?i)\{%.*for\s+.*in\s+.*__subclasses__.*%\}",
    r"(?i)\{%.*if\s+.*__class__.*%\}",
    r"(?i)\{\{.*\|attr\(.*\)\}\}",
    r"(?i)\{\{.*\|format\(.*\)\}\}",
    r"(?i)\{\{.*\|join\(.*\)\}\}",
    r"(?i)\{\{.*\|select\(.*\)\}\}",
    r"(?i)\{\{.*\|map\(.*\)\}\}",
    r"(?i)\{\{.*\|batch\(.*\)\}\}",
    r"(?i)\{\{.*\|slice\(.*\)\}\}",
    r"(?i)\{\{.*\|list\}\}",
    r"(?i)\{\{.*\|string\}\}",
    r"(?i)\{\{.*\|e\}\}",
    r"(?i)\{\{.*\|safe\}\}",
    r"(?i)\{\{.*\|tojson\}\}",
    r"(?i)\{\{.*\|truncate.*\}\}",
    r"(?i)\{\{.*\|replace\(.*\)\}\}",
    r"(?i)\{\{.*\|regex_replace\(.*\)\}\}",
    r"(?i)\{\{.*\|urlencode\}\}",
    r"(?i)\{\{.*\|xmlattr\}\}",
    # --- Pug/Jade SSTI ---
    r"(?i)#\{.*require\(.*\)\}",
    r"(?i)#\{.*process\..*\}",
    r"(?i)#\{.*child_process.*\}",
    r"(?i)#\{.*fs\..*\}",
    r"(?i)-\s*var\s+.*=\s*require\(",
    # --- Smarty/Twig SSTI ---
    r"(?i)\{(?:php|literal|capture|function|include|extends|block|foreach|for|if|while|switch)\}",
    r"(?i)\{\$smarty\.(?:server|session|cookies|request|get|post|env|config|now|const|capture|section|foreach|template|current_dir|version|block|ldelim|rdelim)\}",
    r"(?i)\{(?:system|exec|passthru|shell_exec|popen|proc_open|pcntl_exec)\(",
    # --- ERB/Ruby SSTI ---
    r"(?i)<%=.*`.*`.*%>",
    r"(?i)<%=.*system\(.*%>",
    r"(?i)<%=.*exec\(.*%>",
    r"(?i)<%=.*IO\.popen\(.*%>",
    r"(?i)<%=.*Kernel\.system\(.*%>",
    r"(?i)<%=.*Open3.*%>",
    r"(?i)<%=.*File\.read\(.*%>",
    r"(?i)<%=.*Dir\.glob\(.*%>",
    # --- FreeMarker SSTI ---
    r"(?i)<#assign\s+.*=.*>",
    r"(?i)\$\{.*\?new\(\).*\}",
    r"(?i)<#assign\s+ex\s*=\s*\"freemarker\.template\.utility\.Execute\"",
    r"(?i)<#assign\s+ex\s*=\s*\"freemarker\.template\.utility\.ObjectConstructor\"",
    # --- Velocity SSTI ---
    r"(?i)#set\s*\(\s*\$\w+\s*=\s*\$\w+\.getClass\(\)\)",
    r"(?i)#set\s*\(\s*\$\w+\s*=\s*\$\w+\.forName\(",
    r"(?i)\$\w+\.getRuntime\(\)\.exec\(",
    r"(?i)#foreach.*#end",
    # --- Mako SSTI ---
    r"(?i)<%!?\s*import\s+os\b",
    r"(?i)<%!?\s*import\s+subprocess\b",
    r"(?i)\$\{.*os\.popen.*\}",
    r"(?i)\$\{.*subprocess\..*\}",
    r"(?i)\$\{.*__import__.*\}",
]

# ============================================================================
# 7. DESERIALIZATION DEEP (150 patterns)
# ============================================================================
DESER_DEEP = [
    r"(?i)O:\d+:\"[^\"]+\":\d+:\{",
    r"(?i)a:\d+:\{(?:i:\d+|s:\d+:\")",
    r"(?i)s:\d+:\"(?:system|exec|passthru|shell_exec|popen|proc_open|eval|assert|create_function|call_user_func|preg_replace)\"",
    r"(?i)(?:rO0ABX|aced0005)",
    r"(?i)(?:javax\.management|java\.rmi|org\.apache\.commons|org\.apache\.xalan|com\.sun\.org|sun\.reflect|java\.lang\.Runtime|java\.lang\.ProcessBuilder|java\.lang\.ClassLoader|java\.io\.ObjectInputStream|java\.beans\.XMLDecoder|com\.thoughtworks\.xstream|org\.codehaus\.groovy|org\.springframework|org\.hibernate|com\.beanutils|org\.apache\.wicket|org\.jboss|org\.apache\.catalina|javax\.el|javax\.faces|javax\.management\.remote|javax\.naming|javax\.script|javax\.xml)\b",
    r"(?i)(?:ysoserial|gadgetprobe|marshalsec|jackson-databind|fastjson|flexjson|genson|json-io|json-lib|kryo|xstream|snakeyaml|beanutils|commons-collections|commons-beanutils|commons-io|commons-lang|commons-logging|commons-fileupload|commons-codec|commons-text|commons-compress)\b",
    r"(?i)(?:ObjectInputStream|readObject|readResolve|readExternal|readUnshared|ObjectOutputStream|writeObject|writeReplace|writeExternal|Externalizable|Serializable|readObjectNoData|finalize|ObjectStreamClass|resolveClass|resolveProxyClass|lookupClass|ClassLoader\.loadClass)\b",
    r"(?i)(?:__reduce__|__reduce_ex__|__getstate__|__setstate__|pickle\.loads|pickle\.load|cPickle\.loads|cPickle\.load|shelve\.open|marshal\.loads|marshal\.load|yaml\.load|yaml\.unsafe_load|yaml\.full_load|yaml\.safe_load_all|jsonpickle\.decode|dill\.loads|cloudpickle\.loads)\b",
    r"(?i)(?:BinaryFormatter|ObjectStateFormatter|SoapFormatter|NetDataContractSerializer|DataContractSerializer|DataContractJsonSerializer|JavaScriptSerializer|XmlSerializer|LosFormatter|TypeNameHandling|SerializationBinder|TypeFilterLevel|BinaryServerFormatterSinkProvider|BinaryClientFormatterSinkProvider|SoapServerFormatterSinkProvider|SoapClientFormatterSinkProvider)\b",
    r"(?i)(?:JSON\.parse|JSON\.stringify|eval|Function|serialize|unserialize|json_decode|json_encode|msgpack_unpack|msgpack_pack|igbinary_unserialize|igbinary_serialize|wddx_deserialize|wddx_serialize_value|xmlrpc_decode|xmlrpc_encode)\b",
    r"(?i)(?:NodeJS|node-serialize|serialize-javascript|js-yaml|snakecase|dot-prop|deep-extend|lodash\.merge|lodash\.set|lodash\.defaultsDeep|merge-deep|deepen|deepmerge|object-path|flat|set-value|mixin-deep|mixin-object|defaults-deep|assign-deep|clone-deep|merge-options|deep-assign|object\.assign|Object\.assign|object-assign-deep)\b",
    r"(?i)(?:\$type|__type|_type|@type|@class|javaClass|java\.class|classname|class_name|__class__|__proto__|constructor|prototype\.constructor)\s*(?:=|:|\s)\s*(?:['\"]|{)",
    r"(?i)(?:TypeNameHandling\s*(?:=|:)\s*(?:All|Auto|Objects|Arrays))",
    r"(?i)(?:enableDefaultTyping|activateDefaultTyping|ObjectMapper\.enableDefaultTyping|ObjectMapper\.activateDefaultTyping|SerializationConfig|DeserializationConfig)\b",
    r"(?i)(?:com\.zaxxer\.hikari|com\.mchange\.v2\.c3p0|org\.apache\.tomcat\.dbcp|org\.apache\.commons\.dbcp|javax\.sql\.DataSource|com\.alibaba\.druid|oracle\.jdbc|com\.mysql\.cj|org\.postgresql|com\.microsoft\.sqlserver|net\.sourceforge\.jtds|org\.h2|org\.hsqldb|org\.apache\.derby)\b",
    r"(?i)(?:ClassPathXmlApplicationContext|FileSystemXmlApplicationContext|GenericXmlApplicationContext|AnnotationConfigApplicationContext|WebApplicationContext|ContextLoaderListener|DispatcherServlet|ApplicationContextAware|BeanFactoryAware|InitializingBean|DisposableBean|SmartLifecycle|BeanPostProcessor|BeanFactoryPostProcessor|PropertyPlaceholderConfigurer|PropertySourcesPlaceholderConfigurer)\b",
    r"(?i)(?:viewstate|__VIEWSTATE|__EVENTTARGET|__EVENTARGUMENT|__EVENTVALIDATION)\s*(?:=|:|\s)\s*(?:/[a-zA-Z0-9+/=]+|[a-zA-Z0-9+/=]{50,})",
]

RULES_MEGA_7_MAP = {
    'sql_keywords': SQL_KEYWORDS_INDIVIDUAL,
    'xss_events': XSS_EVENTS_INDIVIDUAL,
    'shell_commands': SHELL_COMMANDS_INDIVIDUAL,
    'sensitive_paths': SENSITIVE_PATHS_INDIVIDUAL,
    'scanner_fingerprints': SCANNER_FINGERPRINTS,
    'ssti_deep': SSTI_DEEP,
    'deser_deep': DESER_DEEP,
}


def get_all_mega7_patterns():
    for category, patterns in RULES_MEGA_7_MAP.items():
        for regex_str in patterns:
            yield (regex_str, category)


def count_mega7_patterns():
    return sum(len(p) for p in RULES_MEGA_7_MAP.values())
